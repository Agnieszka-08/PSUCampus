import{r as c,a as o,j as t}from"./app-Dx9GpVgR.js";import{A}from"./Administrative-BGWoRlZU.js";import"./ApplicationLogo-D0ZzPAVB.js";import"./Dropdown-B15ryQgb.js";import"./transition-BdLuP487.js";import"./NavLink-CXDwq7Se.js";function k(){const[d,m]=c.useState([]),[p,r]=c.useState({picture:null}),[s,h]=c.useState(null),[x,v]=c.useState(!1),[i,l]=c.useState({achievements:"",achievement_pic:null});c.useEffect(()=>{o.get("/achievements/json").then(e=>{m(e.data.achievements||[])}).catch(e=>console.error("Failed to fetch achievements",e))},[]);const f=e=>{l({...i,[e.target.name]:e.target.value})},g=e=>{const{name:a,files:u}=e.target,n=u[0];l({...i,[a]:n}),n&&a==="achievement_pic"&&r({picture:URL.createObjectURL(n)})},j=async()=>{const e=new FormData;e.append("achievements",i.achievements),i.achievement_pic&&e.append("achievement_pic",i.achievement_pic);const a=await o.post("/achievements",e,{headers:{"Content-Type":"multipart/form-data"}});m([a.data,...d])},b=async()=>{const e=new FormData;e.append("_method","PUT"),e.append("achievements",i.achievements),i.achievement_pic&&e.append("achievement_pic",i.achievement_pic);const a=await o.post(`/achievements/${s}`,e,{headers:{"Content-Type":"multipart/form-data"}});m(u=>u.map(n=>n.id===s?a.data:n))},y=async e=>{e.preventDefault(),v(!0);try{s?await b():await j(),l({achievements:"",achievement_pic:null}),r({picture:null}),h(null)}catch(a){console.error("Failed to submit form",a),alert("Something went wrong")}finally{v(!1)}},w=e=>{l({achievements:e.achievements,achievement_pic:null}),r({picture:e.achievement_pic||null}),h(e.id)},N=async e=>{if(confirm("Are you sure you want to delete this achievement?"))try{await o.delete(`/achievements/${e}`),m(d.filter(a=>a.id!==e))}catch(a){console.error("Delete failed",a),alert("Failed to delete achievement.")}},_=()=>{h(null),l({achievements:"",achievement_pic:null}),r({picture:null})};return t.jsx(A,{children:t.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-10",children:[t.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[t.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-800",children:s?"Edit Achievement":"Add Achievement"}),t.jsxs("form",{onSubmit:y,encType:"multipart/form-data",className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Achievement Title"}),t.jsx("input",{type:"text",name:"achievements",placeholder:"Achievement Title",value:i.achievements,onChange:f,required:!0,className:"w-full px-4 py-2 border rounded-xl outline-none focus:ring-2 focus:ring-blue-400"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Achievement Picture"}),t.jsx("div",{className:"w-full h-48 bg-gray-100 rounded-xl flex items-center justify-center overflow-hidden",children:p.picture?t.jsx("img",{src:p.picture,alt:"Preview",className:"w-full h-full object-cover"}):t.jsx("span",{className:"text-gray-400 text-sm",children:"No image selected"})}),t.jsx("input",{type:"file",name:"achievement_pic",accept:"image/*",onChange:g,className:"mt-3 text-sm"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2 bg-blue-600 text-white rounded-xl shadow disabled:opacity-50",children:x?"Saving...":s?"Update":"Save"}),s&&t.jsx("button",{type:"button",onClick:_,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-xl shadow",children:"Cancel"})]})]})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:d.map(e=>t.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 flex flex-col overflow-hidden",children:[e.achievement_pic&&t.jsx("img",{src:e.achievement_pic,className:"w-full h-40 object-cover rounded-xl",alt:""}),t.jsx("div",{className:"mt-4",children:t.jsx("h3",{className:"font-semibold text-gray-800",children:e.achievements})}),t.jsxs("div",{className:"flex justify-end mt-4 gap-3 text-sm",children:[t.jsx("button",{onClick:()=>w(e),className:"text-blue-600 font-medium",children:"Edit"}),t.jsx("button",{onClick:()=>N(e.id),className:"text-red-600 font-medium",children:"Delete"})]})]},e.id))})]})})}export{k as default};
