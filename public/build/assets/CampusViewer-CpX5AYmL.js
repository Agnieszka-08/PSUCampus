import{r as E,j as p,a as yt}from"./app-Bj35u0aw.js";import{W as ue,l as pe}from"./ModelLoader-Bj-44Cu6.js";import{C as me,a as M,M as mt,T as pt,Q as zt,b as $t,V as $,c as fe,P as _e,d as ge,e as ye,f as be,A as we,D as xe,R as Ee,B as lt,S as Tt,G as Ht,g as Wt,h as Zt,i as Kt}from"./three.core-BXuiQTOK.js";import{setupRaycaster as De}from"./RaycasterManager-DpyK2-wN.js";import{flyToTargetSafe as Me,flyToMeshSafe as qt}from"./ControlsManager-DOTcoOXg.js";import{M as Se,I as Pe}from"./InfoPopup-Bwf_Ubpb.js";const Xt={type:"change"},vt={type:"start"},Jt={type:"end"},Et=new fe,Vt=new _e,Te=Math.cos(70*ge.DEG2RAD),D=new M,I=2*Math.PI,m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Rt=1e-6;class Re extends me{constructor(t,s=null){super(t,s),this.state=m.NONE,this.target=new M,this.cursor=new M,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:mt.ROTATE,MIDDLE:mt.DOLLY,RIGHT:mt.PAN},this.touches={ONE:pt.ROTATE,TWO:pt.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new M,this._lastQuaternion=new zt,this._lastTargetPosition=new M,this._quat=new zt().setFromUnitVectors(t.up,new M(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new $t,this._sphericalDelta=new $t,this._scale=1,this._panOffset=new M,this._rotateStart=new $,this._rotateEnd=new $,this._rotateDelta=new $,this._panStart=new $,this._panEnd=new $,this._panDelta=new $,this._dollyStart=new $,this._dollyEnd=new $,this._dollyDelta=new $,this._dollyDirection=new M,this._mouse=new $,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Ce.bind(this),this._onPointerDown=ve.bind(this),this._onPointerUp=Oe.bind(this),this._onContextMenu=Fe.bind(this),this._onMouseWheel=je.bind(this),this._onKeyDown=Ie.bind(this),this._onTouchStart=ke.bind(this),this._onTouchMove=Ne.bind(this),this._onMouseDown=Ae.bind(this),this._onMouseMove=Le.bind(this),this._interceptControlDown=Ge.bind(this),this._interceptControlUp=Ue.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Xt),this.update(),this.state=m.NONE}update(t=null){const s=this.object.position;D.copy(s).sub(this.target),D.applyQuaternion(this._quat),this._spherical.setFromVector3(D),this.autoRotate&&this.state===m.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,d=this.maxAzimuthAngle;isFinite(n)&&isFinite(d)&&(n<-Math.PI?n+=I:n>Math.PI&&(n-=I),d<-Math.PI?d+=I:d>Math.PI&&(d-=I),n<=d?this._spherical.theta=Math.max(n,Math.min(d,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+d)/2?Math.max(n,this._spherical.theta):Math.min(d,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let g=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const C=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),g=C!=this._spherical.radius}if(D.setFromSpherical(this._spherical),D.applyQuaternion(this._quatInverse),s.copy(this.target).add(D),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let C=null;if(this.object.isPerspectiveCamera){const H=D.length();C=this._clampDistance(H*this._scale);const ct=H-C;this.object.position.addScaledVector(this._dollyDirection,ct),this.object.updateMatrixWorld(),g=!!ct}else if(this.object.isOrthographicCamera){const H=new M(this._mouse.x,this._mouse.y,0);H.unproject(this.object);const ct=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),g=ct!==this.object.zoom;const bt=new M(this._mouse.x,this._mouse.y,0);bt.unproject(this.object),this.object.position.sub(bt).add(H),this.object.updateMatrixWorld(),C=D.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;C!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(C).add(this.object.position):(Et.origin.copy(this.object.position),Et.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Et.direction))<Te?this.object.lookAt(this.target):(Vt.setFromNormalAndCoplanarPoint(this.object.up,this.target),Et.intersectPlane(Vt,this.target))))}else if(this.object.isOrthographicCamera){const C=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),C!==this.object.zoom&&(this.object.updateProjectionMatrix(),g=!0)}return this._scale=1,this._performCursorZoom=!1,g||this._lastPosition.distanceToSquared(this.object.position)>Rt||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Rt||this._lastTargetPosition.distanceToSquared(this.target)>Rt?(this.dispatchEvent(Xt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?I/60*this.autoRotateSpeed*t:I/60/60*this.autoRotateSpeed}_getZoomScale(t){const s=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*s)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,s){D.setFromMatrixColumn(s,0),D.multiplyScalar(-t),this._panOffset.add(D)}_panUp(t,s){this.screenSpacePanning===!0?D.setFromMatrixColumn(s,1):(D.setFromMatrixColumn(s,0),D.crossVectors(this.object.up,D)),D.multiplyScalar(t),this._panOffset.add(D)}_pan(t,s){const n=this.domElement;if(this.object.isPerspectiveCamera){const d=this.object.position;D.copy(d).sub(this.target);let g=D.length();g*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*g/n.clientHeight,this.object.matrix),this._panUp(2*s*g/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(s*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,s){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),d=t-n.left,g=s-n.top,C=n.width,H=n.height;this._mouse.x=d/C*2-1,this._mouse.y=-(g/H)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(I*this._rotateDelta.x/s.clientHeight),this._rotateUp(I*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let s=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(I*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),s=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-I*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),s=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(I*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),s=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-I*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),s=!0;break}s&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._rotateStart.set(n,d)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._panStart.set(n,d)}}_handleTouchStartDolly(t){const s=this._getSecondPointerPosition(t),n=t.pageX-s.x,d=t.pageY-s.y,g=Math.sqrt(n*n+d*d);this._dollyStart.set(0,g)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),d=.5*(t.pageX+n.x),g=.5*(t.pageY+n.y);this._rotateEnd.set(d,g)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(I*this._rotateDelta.x/s.clientHeight),this._rotateUp(I*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._panEnd.set(n,d)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const s=this._getSecondPointerPosition(t),n=t.pageX-s.x,d=t.pageY-s.y,g=Math.sqrt(n*n+d*d);this._dollyEnd.set(0,g),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const C=(t.pageX+s.x)*.5,H=(t.pageY+s.y)*.5;this._updateZoomParameters(C,H)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId){this._pointers.splice(s,1);return}}_isTrackingPointer(t){for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId)return!0;return!1}_trackPointer(t){let s=this._pointerPositions[t.pointerId];s===void 0&&(s=new $,this._pointerPositions[t.pointerId]=s),s.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const s=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[s]}_customWheelEvent(t){const s=t.deltaMode,n={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(s){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function ve(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function Ce(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function Oe(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Jt),this.state=m.NONE;break;case 1:const t=this._pointers[0],s=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:s.x,pageY:s.y});break}}function Ae(i){let t;switch(i.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case mt.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=m.DOLLY;break;case mt.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=m.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=m.ROTATE}break;case mt.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=m.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=m.PAN}break;default:this.state=m.NONE}this.state!==m.NONE&&this.dispatchEvent(vt)}function Le(i){switch(this.state){case m.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case m.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case m.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function je(i){this.enabled===!1||this.enableZoom===!1||this.state!==m.NONE||(i.preventDefault(),this.dispatchEvent(vt),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(Jt))}function Ie(i){this.enabled!==!1&&this._handleKeyDown(i)}function ke(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case pt.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=m.TOUCH_ROTATE;break;case pt.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=m.TOUCH_PAN;break;default:this.state=m.NONE}break;case 2:switch(this.touches.TWO){case pt.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=m.TOUCH_DOLLY_PAN;break;case pt.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=m.TOUCH_DOLLY_ROTATE;break;default:this.state=m.NONE}break;default:this.state=m.NONE}this.state!==m.NONE&&this.dispatchEvent(vt)}function Ne(i){switch(this._trackPointer(i),this.state){case m.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case m.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case m.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case m.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=m.NONE}}function Fe(i){this.enabled!==!1&&i.preventDefault()}function Ge(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Ue(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Qt={"3DGeom-1078":{name:"Information Technology Building",department:"College of Information Technology",description:"This building houses computer labs, lecture rooms, and faculty offices for the IT Department."}};function Ke(){const i=E.useRef(null),t=E.useRef(null),s=E.useRef(null),n=E.useRef(null),d=E.useRef(null),g=E.useRef([]),C=E.useRef(null),[H,ct]=E.useState([]),[bt,it]=E.useState(null),[K,wt]=E.useState(null),[Ct,te]=E.useState([]),[ee,se]=E.useState({}),Ot=E.useRef(document.body.style.background),At=E.useRef(document.body.style.overflow),Lt={"3DGeom-5559":"arts_science","3DGeom-10191":"administrative","3DGeom-5890":"education","3DGeom-5891":"education","3DGeom-9084":"sac","3DGeom-4166":"cayetano","3DGeom-4179":"cayetano","3DGeom-4173":"cayetano","3DGeom-3337":"audiovisual","3DGeom-3332":"audiovisual","3DGeom-4309":"agri","3DGeom-4308":"agri","3DGeom-6523":"cc","3DGeom-6071":"cc","3DGeom-6255":"cc","3DGeom-1104":"academic","3DGeom-3177":"twinbldg","3DGeom-9669":"hm_lb","3DGeom-5597":"admin"},Dt={"3DGeom-5559":"Arts and Science Building","3DGeom-10191":"Administrative Building","3DGeom-5890":"Education Building","3DGeom-5891":"Education Building","3DGeom-9084":"Student Activity Center","3DGeom-4166":"Cayetano Building","3DGeom-4179":"Cayetano Building","3DGeom-4173":"Cayetano Building","3DGeom-3337":"Audio Visual Building","3DGeom-3332":"Audio Visual Building","3DGeom-4309":"Agriculture Building","3DGeom-4308":"Agriculture Building","3DGeom-6523":"Covered Court","3DGeom-6071":"Covered Court","3DGeom-6255":"Covered Court","3DGeom-1104":"Academic Building","3DGeom-3177":"Twin Building","3DGeom-9669":"HM Lab Building","3DGeom-5597":"General Update"},Mt=()=>typeof window<"u"?window.innerWidth<768:!1,[u,ie]=E.useState(Mt),[jt,xt]=E.useState(()=>!Mt());E.useEffect(()=>{if(typeof window>"u")return;const e=()=>ie(Mt());return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),E.useEffect(()=>{xt(!u)},[u]);const It=async(e,l,S,f=null)=>{try{const[o,a,v,R,r]=await Promise.all([yt.get(`/info-building/${e}`),yt.get(`/happenings/${e}`),yt.get(`/services/${e}`),yt.get(`/achievements/${e}`),yt.get(`/announcements/${e}`)]),Y=Array.isArray(o.data)?o.data:o.data?[o.data]:[],q=Array.isArray(a.data)?a.data:a.data?[a.data]:[],ot=Array.isArray(v.data)?v.data:v.data?[v.data]:[],X=Array.isArray(R.data)?R.data:R.data?[R.data]:[],nt=Array.isArray(r.data)?r.data:r.data?[r.data]:[],P=Y,V=q,ft=ot,Ft=X,Gt=nt;wt({id:e,name:P.name||f?.name||e.toUpperCase(),department:e.toUpperCase(),happenings:V,services:ft,achievements:Ft,announcements:Gt,infoDetails:P,infoCount:Y.length,happCount:q.length,serviceCount:ot.length,achievementCount:X.length,announcementCount:nt.length,x:l,y:S,_rawInfo:Y,_rawHappenings:q,_rawServices:ot,_rawAchievements:X,_rawAnnouncements:nt})}catch(o){console.error("Error fetching popup data:",o)}};function oe(e,l=256,S=256){const f=document.createElement("canvas");f.width=l,f.height=S;const o=f.getContext("2d");o.clearRect(0,0,l,S);const a=new Kt(f),v=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),R=URL.createObjectURL(v),r=new Image;return r.onload=()=>{o.clearRect(0,0,l,S),o.drawImage(r,0,0,l,S),a.needsUpdate=!0,URL.revokeObjectURL(R)},r.onerror=()=>{a.needsUpdate=!0,URL.revokeObjectURL(R)},r.src=R,a}function ne(e=256,l="#ce1319ff",S=""){const f=(S||"").split(/\s+/).filter(Boolean),o=[];let a="";for(let P of f)a?(a+" "+P).length>12&&o.length<2?(o.push(a),a=P):a=a?a+" "+P:P:a=P;for(a&&o.push(a);o.length<1;)o.push("");const v=Math.round(e/2),R=Math.round(e*.36),r=Math.round(e*.14),Y=Math.round(R+r*2.2),q=P=>String(P).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),ot=Math.round(e*.09),X=Math.round(e*.11),nt=`
<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 ${e} ${e}">
  <defs>
    <linearGradient id="g" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="${l}" stop-opacity="1"/>
      <stop offset="1" stop-color="${l}" stop-opacity="0.88"/>
    </linearGradient>
  </defs>

  <!-- soft shadow -->
  <ellipse cx="${v}" cy="${Y+Math.round(e*.04)}" rx="${Math.round(r*1.25)}" ry="${Math.round(r*.6)}" fill="rgba(0,0,0,0.18)"/>

  <!-- teardrop pin (circle + pointed tail merged via path) -->
  <path d="M ${v} ${Y} L ${v+r} ${R} A ${r} ${r} 0 1 0 ${v-r} ${R} Z" fill="url(#g)"/>

  <!-- subtle highlight -->
  <ellipse cx="${v-Math.round(r*.35)}" cy="${R-Math.round(r*.35)}" rx="${Math.round(r*.45)}" ry="${Math.round(r*.25)}" fill="rgba(255,255,255,0.55)"/>

  <!-- inner white center -->
  <circle cx="${v}" cy="${R}" r="${Math.round(r*.45)}" fill="#fff"/>

  <!-- label below pin (up to 3 lines) -->
  <g font-family="sans-serif" font-size="${ot}" fill="#222" text-anchor="middle">
    ${o.slice(0,3).map((P,V)=>{const ft=Y+Math.round(X*.9)+V*X;return`<text x="${v}" y="${ft}">${q(P)}</text>`}).join("")}
  </g>
</svg>`.trim();return oe(nt,e,e)}E.useEffect(()=>{const e=i.current;if(!e)return;try{document.documentElement.style.margin="0",document.body.style.margin="0",document.documentElement.style.height="100%",document.body.style.height="100%"}catch{}e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="100vw",e.style.height="100vh",e.style.zIndex="0",At.current=document.body.style.overflow,Ot.current=document.body.style.background;try{document.body.style.background="linear-gradient(to bottom, #87CEEB 0%, #e0f7ff 100%)"}catch{}document.body.style.overflow="hidden";const l=new ye;l.background=null;const S=e.clientWidth,f=e.clientHeight,o=new be(45,S/f,.1,1e3);o.position.set(0,20,40),s.current=o;const a=new ue({antialias:!1,alpha:!0});a.setSize(S,f),a.domElement.style.display="block",a.domElement.style.width="100%",a.domElement.style.height="100%",a.domElement.style.objectFit="cover",a.setPixelRatio(1),a.shadowMap.enabled=!1,a.setClearColor(0,0),d.current=a,e.appendChild(a.domElement);const v=new we(16777215,.8);l.add(v);const R=new xe(16777215,.6);R.position.set(10,20,10),l.add(R);const r=new Re(o,a.domElement);r.enableDamping=!1,r.target.set(0,5,0),r.minPolarAngle=0,r.maxPolarAngle=Math.PI/2-.01,r.screenSpacePanning=!1,n.current=r,window.__campus_camera=o,window.__campus_controls=r;let Y=!1,q=null;const ot=80;let X=0;const nt=()=>a.render(l,o);function P(){const c=performance.now(),z=Math.max(0,ot-(c-X));Y||(Y=!0,q=setTimeout(()=>{Y=!1,X=performance.now(),nt()},z))}window.__campus_requestRender=P,r.addEventListener("change",P);let V=null;function ft(c){function z(b=256){const A=document.createElement("canvas");A.width=b,A.height=b;const G=A.getContext("2d"),N=G.createRadialGradient(b/2,b/2,b*.05,b/2,b/2,b/2);N.addColorStop(0,"rgba(255,255,255,0.95)"),N.addColorStop(.6,"rgba(255,255,255,0.65)"),N.addColorStop(1,"rgba(255,255,255,0)"),G.fillStyle=N,G.fillRect(0,0,b,b);const J=new Kt(A);return J.needsUpdate=!0,J}V=new Ht;const at=z(256),St=Math.min(24,Math.max(6,Math.floor(c/8)));for(let b=0;b<St;b++){const A=new Wt({map:at,transparent:!0,opacity:0,depthWrite:!1}),G=new Zt(A),N=c*1.6;G.position.set((Math.random()-.5)*N,c*(.8+Math.random()*1),(Math.random()-.5)*N);const J=c*(.25+Math.random()*.6);G.scale.set(J,J*.6,1),V.add(G)}V.position.y=0,l.add(V);let et=0;const Q=60;let rt=performance.now();function Z(){et++;const b=Math.min(1,et/Q);V.children.forEach((A,G)=>{A.material.opacity=b*(.6+G%3*.12);const N=performance.now(),J=(N-rt)/1e3;A.position.x+=Math.sin(N/1e4+G)*.02*J*Math.max(10,1)}),rt=performance.now(),a.render(l,o),et<Q&&requestAnimationFrame(Z)}Z()}C.current=new Ee,pe("/models/psucampus.glb").then(c=>{t.current=c,l.add(c);const at=new lt().setFromObject(c).getCenter(new M);c.position.sub(at);const Q=new lt().setFromObject(c).getBoundingSphere(new Tt).radius||10;ft(Q);const rt=o.fov*Math.PI/180,Z=Math.abs(Q/Math.sin(rt/2));o.position.set(0,Q*.6+Z*.05,Z*1.2),o.near=Math.max(.1,Z/100),o.far=Z*10,o.lookAt(new M(0,0,0)),o.updateProjectionMatrix(),r.target.set(0,0,0),r.update(),g.current=[];const A=new Map;let G=1;c.traverse(_=>{if(!_.isMesh)return;const F=new lt().setFromObject(_),U=new M;if(F.getSize(U),U.length()<.8)return;const T=_.userData?.buildingName,L=_.userData?.name,j=_.name&&_.name!==""?_.name:null,O=T||L||j||`Building ${G++}`;A.has(O)||A.set(O,[]),A.get(O).push(_)});const N=[];for(const[_,F]of A.entries()){const U=new lt;for(const B of F){const ht=new lt().setFromObject(B);U.union(ht)}const w=U.getCenter(new M),L=U.getBoundingSphere(new Tt).radius||Math.max(...F.map(B=>new lt().setFromObject(B).getSize(new M).length()))||5,j=Math.max(1,U.getSize(new M).y*.5+1),O=_;g.current.push({id:O,name:_,meshes:F,center:w,radius:L,offsetY:j}),N.push({id:O,name:_})}ct(N),P();try{const _=new Ht;_.renderOrder=999;const F=new Map;c.traverse(w=>{if(!w.isMesh)return;const T=Lt[w.name];if(!T)return;const L=new lt().setFromObject(w),O=L.getBoundingSphere(new Tt).radius||L.getSize(new M).length();if(!F.has(T))F.set(T,{nodes:[w],bbox:L.clone(),bestNode:w,bestMetric:O});else{const B=F.get(T);B.nodes.push(w),B.bbox.union(L),O>B.bestMetric&&(B.bestMetric=O,B.bestNode=w)}});for(const[w,T]of F.entries()){const L=T.bbox.getCenter(new M),j=Math.max(.6,(T.bestMetric||1)*.6),O=Dt[T.bestNode.name]||T.bestNode.userData?.buildingName||w,B=ne(256,"#ff5a5f",O),ht=new Wt({map:B,transparent:!0,depthTest:!1,depthWrite:!1,alphaTest:.01}),x=new Zt(ht);x.position.copy(L),x.position.y+=Math.max(.25,j*.6),x.scale.set(j,j,1),x.userData={isPin:!0,role:w,displayName:O,targetMesh:T.bestNode,meshes:T.nodes},x.renderOrder=1e3,x.frustumCulled=!1,_.add(x)}l.add(_);try{const w={"3DGeom-5559":"GENERAL EDUCATION DEPARTMENT Office","3DGeom-5586":"PRODUCTION and AUXILIARY SERVICES OFFICE"},T={},L=(x,dt)=>{const tt=(x.name||"")+" "+(x.userData?.buildingName||"")+" "+(x.userData?.name||""),h=String(tt).toLowerCase();if(h.includes("hmo")||h.includes("hospitality")||h.includes("management"))return"hmo";if(h.includes("boa")||h.includes("business")||h.includes("office administration"))return"boa";if(h.includes("it")||h.includes("information")||h.includes("technology"))return"it_dept";if(h.includes("ced")||h.includes("campus executive"))return"ced";if(h.includes("coa")||h.includes("college of agriculture")||h.includes("agriculture"))return"coa";if(h.includes("registrar"))return"registrar";if(h.includes("mis"))return"mis";if(h.includes("administrative")&&h.includes("office"))return"administrative_office";if(h.includes("supply"))return"supply_office";if(h.includes("account")||h.includes("accounting"))return"accounting_office";if(h.includes("cashier"))return"cashier_office";if(h.includes("library"))return"library_office";if(h.includes("guidance"))return"guidance_office";if(h.includes("student services")||h.includes("student_services")||h.includes("student service"))return"student_services_office";if(h.includes("supreme")||h.includes("student council")||h.includes("ssc"))return"supreme_student_council";if(h.includes("clinic")||h.includes("health"))return"clinic";if(dt&&dt!==x.name){const gt=(x.name||"").toLowerCase().replace(/[^a-z0-9_]+/g,"_");if(gt&&gt.length>2)return gt}return null},j=[],O={academic:["hmo","boa","it_dept","ced","coa"],administrative:["registrar","mis","administrative_office","supply_office","accounting_office","cashier_office","library_office"],sac:["guidance_office","student_services_office","supreme_student_council","clinic"],arts_science:["gened","paso"]},B={hmo:"1st Floor",boa:"3rd Floor",it_dept:"2nd Floor",ced:"2nd Floor",coa:"1st Floor",gened:"1st Floor",paso:"1st Floor",guidance:"2nd Floor",sso:"2nd Floor",ssc:"2nd Floor",clinic:"1st Floor",registrar:"1st Floor",mis:"1st Floor",admin:"1st Floor",supply:"1st Floor",accounting:"1st Floor",cashier:"1st Floor",library:"2nd Floor"},ht={hmo:"Hospitality Management Office",boa:"Business & Office Administration Department",it_dept:"Information Technology Department",ced:"Campus Executive Director Office",coa:"College of Agriculture",registrar:"Registrar's Office",mis:"Management Information Systems (MIS)",administrative_office:"Administrative Office",supply_office:"Supply Office",accounting_office:"Accounting Office",cashier_office:"Cashier",library_office:"Library",guidance_office:"Guidance Office",student_services_office:"Student Services Office",supreme_student_council:"Supreme Student Council",clinic:"Clinic / Health Center",gened:"General Education",paso:"Production and Auxiliary Services Office"};for(const[x,dt]of F.entries()){const tt=dt.bestNode,h={id:tt.name||tt.uuid,role:x,displayName:Dt[tt.name]||tt.userData?.buildingName||x,mesh:tt,meshes:dt.nodes,children:[]};if(["arts_science","academic","administrative","sac"].includes(x)){const gt=tt.name||tt.uuid,Bt=dt.nodes.map(y=>{const ut=y.name||y.uuid,st=T[ut]||L(y,x)||null,de=(st?ht[st]:null)||w[ut]||Dt[ut]||y.userData?.buildingName||y.userData?.name||ut;return{id:ut,displayName:de,role:st,mesh:y}}).filter(y=>y.id!==gt&&y.displayName&&y.displayName!==h.displayName),Pt=[...[...Bt.filter(y=>y.role),...Bt.filter(y=>!y.role)]],he=O[x]||[];for(const y of he)if(!Pt.some(st=>st.role===y||st.id===y)){const st=Qt[y]||{},Yt=ht[y]||st?.name||y;Pt.push({id:y,displayName:Yt,role:y,mesh:null})}h.children=Pt}j.push(h)}te(j)}catch(w){console.warn("Failed to collect pinned items:",w)}const U=window.__campus_requestRender;U&&U()}catch(_){console.warn("Failed to create pins:",_)}const J="3DGeom-5597",_t=g.current.find(_=>_.id===J);if(_t){it(_t.id);try{const _=_t.center.clone();_.y+=_t.offsetY||2;const F=_t.radius||5,U=o.fov*Math.PI/180,w=Math.abs(F/Math.sin(U/2))*1.2,T=new M(1,.6,1).normalize(),L=_.clone().add(T.multiplyScalar(w));o.position.copy(L),r.target.copy(_),r.update();const j=window.__campus_requestRender;j&&j()}catch{}}}).catch(c=>{console.error("Error loading model:",c)}),De(a,o,()=>({children:[t.current,...l.children.filter(c=>c.renderOrder>=999)]}),(c,z,at)=>{if(!t.current)return;if(c.userData?.isPin){const rt=c.userData.role||null,Z=c.userData.displayName||null;if(rt){It(rt,z,at,Z?{name:Z}:null),it(c.userData.targetMesh?.name||c.userData.targetMesh?.uuid);const b=window.__campus_requestRender;b&&b();return}}const et=Lt[c.name];if(!et)return;fetchInfoForRoleAndShowPopup(et,z,at,null),fetchHappeningsForShowPopup(et,z,at,null),it(c.name||c.uuid);const Q=window.__campus_requestRender;Q&&Q()});const Ut=()=>{const c=e.clientWidth,z=e.clientHeight;o.aspect=c/z,o.updateProjectionMatrix(),a.setSize(c,z)};return window.addEventListener("resize",Ut),P(),()=>{q&&clearTimeout(q);try{delete window.__campus_requestRender}catch{}window.removeEventListener("resize",Ut),r.removeEventListener("change",P);try{a.domElement.remove()}catch{}r.dispose(),a.dispose(),document.body.style.overflow=At.current;try{delete window.__campus_camera,delete window.__campus_controls}catch{}a.domElement&&a.domElement.parentNode&&a.domElement.parentNode.removeChild(a.domElement);try{document.body.style.background=Ot.current}catch{}}},[]);const ae=e=>{if(!(!e||!e.mesh))try{qt(e.mesh,{padding:Math.max(2,e.mesh.userData?.padding||2),animate:!0,frames:45},s,n,t),it(e.mesh.name||e.id);const l=window.__campus_requestRender;l&&l()}catch(l){console.warn("Fly to pin failed:",l)}},kt=e=>{if(e)try{if(e.role)It(e.role,window.innerWidth/2,window.innerHeight/2,{name:e.displayName}),it(e.mesh?.name||e.id);else{const S=Qt[e.id]||null;wt({id:e.id,name:S?.name||e.displayName||e.id,department:S?.department,description:S?.description,count:e.mesh?1:0,x:window.innerWidth/2,y:window.innerHeight/2}),it(e.id)}const l=window.__campus_requestRender;l&&l()}catch(l){console.warn("Open info failed:",l)}},k="#003366",W="#FFB81C",Nt="#E8F0F7",re={position:u?"fixed":"absolute",left:u?"50%":10,top:u?"auto":10,bottom:u?20:"auto",transform:u?"translateX(-50%)":"none",zIndex:30,background:k,color:"white",border:"none",padding:"10px 14px",borderRadius:8,cursor:"pointer",fontWeight:600,boxShadow:"0 4px 10px rgba(0,0,0,0.2)",width:u?"calc(100vw - 2.5rem)":"auto",maxWidth:u?420:"auto"},le={position:u?"fixed":"absolute",left:u?"50%":10,top:u?"auto":10,bottom:u?20:"auto",transform:u?"translateX(-50%)":"none",width:u?"calc(100vw - 2rem)":330,maxWidth:420,maxHeight:u?"60vh":"calc(100vh - 20px)",overflowY:"auto",padding:0,borderRadius:12,zIndex:20,background:"#ffffff",boxShadow:"0 10px 25px rgba(0, 51, 102, 0.15)",border:`2px solid ${k}`},ce={position:"fixed",right:u?"auto":0,left:u?0:"auto",bottom:u?0:"auto",top:u?"auto":0,width:u?"100%":340,maxWidth:u?"100%":360,height:u?"auto":"100vh",maxHeight:u?"80vh":"100vh",background:"rgba(255,255,255,0.98)",boxShadow:u?"0 -8px 20px rgba(0,0,0,0.2)":"2px 0 16px rgba(0,0,0,0.10)",zIndex:60,padding:u?"16px 20px":24,overflowY:"auto",transition:"transform 0.3s ease",transform:K?u?"translateY(0)":"translateX(0)":u?"translateY(110%)":"translateX(110%)",pointerEvents:K?"auto":"none",borderRadius:u?"16px 16px 0 0":0,display:"flex",flexDirection:"column"};return p.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[p.jsx("div",{ref:i}),!jt&&p.jsx("button",{onClick:()=>xt(!0),style:re,children:"Show Buildings"}),jt&&p.jsxs("div",{style:le,children:[p.jsx("div",{style:{background:`linear-gradient(135deg, ${k} 0%, ${k}dd 100%)`,padding:"16px 20px",borderRadius:"10px 10px 0 0",borderBottom:`3px solid ${W}`},children:p.jsxs("div",{style:{fontWeight:700,color:W,fontSize:16,letterSpacing:.5,display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[p.jsx(Se,{size:20,color:W}),"PSU BUILDINGS"]}),p.jsx("button",{onClick:()=>xt(!1),className:"text-gray-400 hover:text-gray-200 text-sm",children:"✕"})]})}),p.jsx("div",{style:{padding:"12px",display:"flex",flexDirection:"column",gap:10},children:Ct.length===0?p.jsx("div",{style:{color:"#999",fontSize:13,textAlign:"center",padding:"20px 10px"},children:"Loading campus buildings..."}):Ct.map(e=>{const l=!!ee[e.id],S=bt===(e.mesh?.name||e.id);return p.jsxs("div",{children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:S?Nt:"#f8f9fa",padding:"10px 12px",borderRadius:8,border:S?`2px solid ${k}`:"1px solid #e0e0e0",transition:"all 0.2s ease"},children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:[e.children&&e.children.length>0&&p.jsx("button",{onClick:()=>se(f=>({...f,[e.id]:!f[e.id]})),style:{border:"none",background:"transparent",cursor:"pointer",padding:4,fontSize:14,color:k,transition:"transform 0.2s",transform:l?"rotate(180deg)":"rotate(0)"},"aria-label":l?"Collapse":"Expand",children:"▾"}),!e.children||e.children.length===0&&p.jsx("div",{style:{width:24}}),p.jsx("div",{style:{flex:1},children:p.jsx("div",{style:{fontSize:13,fontWeight:600,color:k},children:e.displayName})})]}),p.jsx("div",{style:{display:"flex",gap:6},children:p.jsx("button",{onClick:()=>{ae(e),kt(e)},style:{background:k,color:"#fff",border:"none",padding:"6px 12px",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:600,transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 51, 102, 0.2)"},onMouseEnter:f=>{f.target.style.background=W,f.target.style.color=k},onMouseLeave:f=>{f.target.style.background=k,f.target.style.color="#fff"},children:"View"})})]}),e.children&&e.children.length>0&&l&&p.jsx("div",{style:{marginTop:8,marginLeft:0,display:"flex",flexDirection:"column",gap:6,paddingLeft:12,borderLeft:`3px solid ${W}`},children:e.children&&e.children.length>0&&l&&p.jsx("div",{style:{marginTop:8,marginLeft:0,display:"flex",flexDirection:"column",gap:6,paddingLeft:12,borderLeft:`3px solid ${W}`},children:e.children.map(f=>p.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:6,background:"#f0f4f8",border:"1px solid #d0d9e8",transition:"all 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.background=Nt,o.currentTarget.style.borderColor=W},onMouseLeave:o=>{o.currentTarget.style.background="#f0f4f8",o.currentTarget.style.borderColor="#d0d9e8"},children:[p.jsx("div",{style:{flex:1},children:p.jsxs("div",{style:{fontSize:12,color:"#333",fontWeight:500},children:[f.displayName,f.floor&&` - ${f.floor}`," "]})}),p.jsx("button",{onClick:()=>kt(f),style:{background:W,color:k,border:"none",padding:"4px 8px",borderRadius:4,cursor:"pointer",fontSize:11,fontWeight:600,transition:"all 0.2s ease"},onMouseEnter:o=>{o.target.style.background=k,o.target.style.color=W},onMouseLeave:o=>{o.target.style.background=W,o.target.style.color=k},children:"Info"})]},f.id))})})]},e.id)})})]}),p.jsx("div",{style:ce,children:K&&p.jsx(Pe,{popupInfo:K,onClose:()=>{wt(null),it(null)},onFlyTo:()=>{if(!K)return;const e=g.current.find(l=>l.id===K.id);e?Me(e,s,n):K._mesh&&qt(K._mesh,{padding:K._meshRadius||2,animate:!0,frames:45},s,n,t),wt(null)}})}),p.jsx("div",{"aria-label":"Camera controls",style:{position:"fixed",right:20,bottom:20,width:120,height:120,display:"flex",alignItems:"center",justifyContent:"center",zIndex:40,pointerEvents:"auto"}})]})}export{Ke as default};
