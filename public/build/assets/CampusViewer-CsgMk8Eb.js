import{r as D,j as m,a as yt}from"./app-Dhzd1B7P.js";import{W as pe,l as me}from"./ModelLoader-Bj-44Cu6.js";import{C as fe,a as S,M as mt,T as pt,Q as zt,b as $t,V as $,c as _e,P as ge,d as ye,e as be,f as we,A as xe,D as Ee,R as De,B as ct,S as Rt,G as Ht,g as Wt,h as Zt,i as Kt}from"./three.core-BXuiQTOK.js";import{setupRaycaster as Me}from"./RaycasterManager-DpyK2-wN.js";import{flyToTargetSafe as Se,flyToMeshSafe as qt}from"./ControlsManager-DOTcoOXg.js";import{M as Pe,I as Re}from"./InfoPopup-CE81ChwD.js";const Xt={type:"change"},vt={type:"start"},Jt={type:"end"},Et=new _e,Vt=new ge,Te=Math.cos(70*ye.DEG2RAD),M=new S,k=2*Math.PI,f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Tt=1e-6;class ve extends fe{constructor(t,s=null){super(t,s),this.state=f.NONE,this.target=new S,this.cursor=new S,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:mt.ROTATE,MIDDLE:mt.DOLLY,RIGHT:mt.PAN},this.touches={ONE:pt.ROTATE,TWO:pt.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new S,this._lastQuaternion=new zt,this._lastTargetPosition=new S,this._quat=new zt().setFromUnitVectors(t.up,new S(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new $t,this._sphericalDelta=new $t,this._scale=1,this._panOffset=new S,this._rotateStart=new $,this._rotateEnd=new $,this._rotateDelta=new $,this._panStart=new $,this._panEnd=new $,this._panDelta=new $,this._dollyStart=new $,this._dollyEnd=new $,this._dollyDelta=new $,this._dollyDirection=new S,this._mouse=new $,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Oe.bind(this),this._onPointerDown=Ce.bind(this),this._onPointerUp=Ae.bind(this),this._onContextMenu=Ge.bind(this),this._onMouseWheel=Ie.bind(this),this._onKeyDown=ke.bind(this),this._onTouchStart=Ne.bind(this),this._onTouchMove=Fe.bind(this),this._onMouseDown=Le.bind(this),this._onMouseMove=je.bind(this),this._interceptControlDown=Ue.bind(this),this._interceptControlUp=Be.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Xt),this.update(),this.state=f.NONE}update(t=null){const s=this.object.position;M.copy(s).sub(this.target),M.applyQuaternion(this._quat),this._spherical.setFromVector3(M),this.autoRotate&&this.state===f.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,d=this.maxAzimuthAngle;isFinite(n)&&isFinite(d)&&(n<-Math.PI?n+=k:n>Math.PI&&(n-=k),d<-Math.PI?d+=k:d>Math.PI&&(d-=k),n<=d?this._spherical.theta=Math.max(n,Math.min(d,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+d)/2?Math.max(n,this._spherical.theta):Math.min(d,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let y=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const C=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),y=C!=this._spherical.radius}if(M.setFromSpherical(this._spherical),M.applyQuaternion(this._quatInverse),s.copy(this.target).add(M),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let C=null;if(this.object.isPerspectiveCamera){const H=M.length();C=this._clampDistance(H*this._scale);const ht=H-C;this.object.position.addScaledVector(this._dollyDirection,ht),this.object.updateMatrixWorld(),y=!!ht}else if(this.object.isOrthographicCamera){const H=new S(this._mouse.x,this._mouse.y,0);H.unproject(this.object);const ht=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),y=ht!==this.object.zoom;const bt=new S(this._mouse.x,this._mouse.y,0);bt.unproject(this.object),this.object.position.sub(bt).add(H),this.object.updateMatrixWorld(),C=M.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;C!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(C).add(this.object.position):(Et.origin.copy(this.object.position),Et.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Et.direction))<Te?this.object.lookAt(this.target):(Vt.setFromNormalAndCoplanarPoint(this.object.up,this.target),Et.intersectPlane(Vt,this.target))))}else if(this.object.isOrthographicCamera){const C=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),C!==this.object.zoom&&(this.object.updateProjectionMatrix(),y=!0)}return this._scale=1,this._performCursorZoom=!1,y||this._lastPosition.distanceToSquared(this.object.position)>Tt||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Tt||this._lastTargetPosition.distanceToSquared(this.target)>Tt?(this.dispatchEvent(Xt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?k/60*this.autoRotateSpeed*t:k/60/60*this.autoRotateSpeed}_getZoomScale(t){const s=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*s)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,s){M.setFromMatrixColumn(s,0),M.multiplyScalar(-t),this._panOffset.add(M)}_panUp(t,s){this.screenSpacePanning===!0?M.setFromMatrixColumn(s,1):(M.setFromMatrixColumn(s,0),M.crossVectors(this.object.up,M)),M.multiplyScalar(t),this._panOffset.add(M)}_pan(t,s){const n=this.domElement;if(this.object.isPerspectiveCamera){const d=this.object.position;M.copy(d).sub(this.target);let y=M.length();y*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*y/n.clientHeight,this.object.matrix),this._panUp(2*s*y/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(s*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,s){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),d=t-n.left,y=s-n.top,C=n.width,H=n.height;this._mouse.x=d/C*2-1,this._mouse.y=-(y/H)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(k*this._rotateDelta.x/s.clientHeight),this._rotateUp(k*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let s=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(k*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),s=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-k*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),s=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(k*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),s=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-k*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),s=!0;break}s&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._rotateStart.set(n,d)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._panStart.set(n,d)}}_handleTouchStartDolly(t){const s=this._getSecondPointerPosition(t),n=t.pageX-s.x,d=t.pageY-s.y,y=Math.sqrt(n*n+d*d);this._dollyStart.set(0,y)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),d=.5*(t.pageX+n.x),y=.5*(t.pageY+n.y);this._rotateEnd.set(d,y)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(k*this._rotateDelta.x/s.clientHeight),this._rotateUp(k*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._panEnd.set(n,d)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const s=this._getSecondPointerPosition(t),n=t.pageX-s.x,d=t.pageY-s.y,y=Math.sqrt(n*n+d*d);this._dollyEnd.set(0,y),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const C=(t.pageX+s.x)*.5,H=(t.pageY+s.y)*.5;this._updateZoomParameters(C,H)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId){this._pointers.splice(s,1);return}}_isTrackingPointer(t){for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId)return!0;return!1}_trackPointer(t){let s=this._pointerPositions[t.pointerId];s===void 0&&(s=new $,this._pointerPositions[t.pointerId]=s),s.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const s=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[s]}_customWheelEvent(t){const s=t.deltaMode,n={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(s){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function Ce(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function Oe(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function Ae(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Jt),this.state=f.NONE;break;case 1:const t=this._pointers[0],s=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:s.x,pageY:s.y});break}}function Le(i){let t;switch(i.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case mt.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=f.DOLLY;break;case mt.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=f.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=f.ROTATE}break;case mt.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=f.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=f.PAN}break;default:this.state=f.NONE}this.state!==f.NONE&&this.dispatchEvent(vt)}function je(i){switch(this.state){case f.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case f.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case f.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function Ie(i){this.enabled===!1||this.enableZoom===!1||this.state!==f.NONE||(i.preventDefault(),this.dispatchEvent(vt),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(Jt))}function ke(i){this.enabled!==!1&&this._handleKeyDown(i)}function Ne(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case pt.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=f.TOUCH_ROTATE;break;case pt.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=f.TOUCH_PAN;break;default:this.state=f.NONE}break;case 2:switch(this.touches.TWO){case pt.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=f.TOUCH_DOLLY_PAN;break;case pt.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=f.TOUCH_DOLLY_ROTATE;break;default:this.state=f.NONE}break;default:this.state=f.NONE}this.state!==f.NONE&&this.dispatchEvent(vt)}function Fe(i){switch(this._trackPointer(i),this.state){case f.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case f.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case f.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case f.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=f.NONE}}function Ge(i){this.enabled!==!1&&i.preventDefault()}function Ue(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Be(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Qt={"3DGeom-1078":{name:"Information Technology Building",department:"College of Information Technology",description:"This building houses computer labs, lecture rooms, and faculty offices for the IT Department."}};function qe(){const i=D.useRef(null),t=D.useRef(null),s=D.useRef(null),n=D.useRef(null),d=D.useRef(null),y=D.useRef([]),C=D.useRef(null),[H,ht]=D.useState([]),[bt,it]=D.useState(null),[Z,wt]=D.useState(null),[Ct,te]=D.useState([]),[ee,se]=D.useState({}),Ot=D.useRef(document.body.style.background),At=D.useRef(document.body.style.overflow),Lt={"3DGeom-5559":"arts_science","3DGeom-10191":"administrative","3DGeom-5890":"education","3DGeom-5891":"education","3DGeom-9084":"sac","3DGeom-4166":"cayetano","3DGeom-4179":"cayetano","3DGeom-4173":"cayetano","3DGeom-3337":"audiovisual","3DGeom-3332":"audiovisual","3DGeom-4309":"agri","3DGeom-4308":"agri","3DGeom-6523":"cc","3DGeom-6071":"cc","3DGeom-6255":"cc","3DGeom-1104":"academic","3DGeom-3177":"twinbldg","3DGeom-9669":"hm_lb","3DGeom-5597":"admin"},Dt={"3DGeom-5559":"Arts and Science Building","3DGeom-10191":"Administrative Building","3DGeom-5890":"Education Building","3DGeom-5891":"Education Building","3DGeom-9084":"Student Activity Center","3DGeom-4166":"Cayetano Building","3DGeom-4179":"Cayetano Building","3DGeom-4173":"Cayetano Building","3DGeom-3337":"Audio Visual Building","3DGeom-3332":"Audio Visual Building","3DGeom-4309":"Agriculture Building","3DGeom-4308":"Agriculture Building","3DGeom-6523":"Covered Court","3DGeom-6071":"Covered Court","3DGeom-6255":"Covered Court","3DGeom-1104":"Academic Building","3DGeom-3177":"Twin Building","3DGeom-9669":"HM Lab Building","3DGeom-5597":"General Update"},Mt=()=>typeof window<"u"?window.innerWidth<768:!1,[u,ie]=D.useState(Mt),[jt,xt]=D.useState(()=>!Mt());D.useEffect(()=>{if(typeof window>"u")return;const e=()=>ie(Mt());return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),D.useEffect(()=>{xt(!u)},[u]);const It=async(e,h,P,p=null)=>{try{const[o,a,v,T,r]=await Promise.all([yt.get(`/info-building/${e}`),yt.get(`/happenings/${e}`),yt.get(`/services/${e}`),yt.get(`/achievements/${e}`),yt.get(`/announcements/${e}`)]),Y=Array.isArray(o.data)?o.data:o.data?[o.data]:[],q=Array.isArray(a.data)?a.data:a.data?[a.data]:[],ot=Array.isArray(v.data)?v.data:v.data?[v.data]:[],X=Array.isArray(T.data)?T.data:T.data?[T.data]:[],nt=Array.isArray(r.data)?r.data:r.data?[r.data]:[],b=Y,V=q,ft=ot,Ft=X,Gt=nt;wt({id:e,name:b.name||p?.name||e.toUpperCase(),description:b.information||p?.information||e.toUpperCase(),department:e.toUpperCase(),happenings:V,services:ft,achievements:Ft,announcements:Gt,infoDetails:b,infoCount:Y.length,happCount:q.length,serviceCount:ot.length,achievementCount:X.length,announcementCount:nt.length,x:h,y:P,_rawInfo:Y,_rawHappenings:q,_rawServices:ot,_rawAchievements:X,_rawAnnouncements:nt})}catch(o){console.error("Error fetching popup data:",o)}};function oe(e,h=256,P=256){const p=document.createElement("canvas");p.width=h,p.height=P;const o=p.getContext("2d");o.clearRect(0,0,h,P);const a=new Kt(p),v=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),T=URL.createObjectURL(v),r=new Image;return r.onload=()=>{o.clearRect(0,0,h,P),o.drawImage(r,0,0,h,P),a.needsUpdate=!0,URL.revokeObjectURL(T)},r.onerror=()=>{a.needsUpdate=!0,URL.revokeObjectURL(T)},r.src=T,a}function ne(e=256,h="#ce1319ff",P=""){const p=(P||"").split(/\s+/).filter(Boolean),o=[];let a="";for(let b of p)a?(a+" "+b).length>12&&o.length<2?(o.push(a),a=b):a=a?a+" "+b:b:a=b;for(a&&o.push(a);o.length<1;)o.push("");const v=Math.round(e/2),T=Math.round(e*.36),r=Math.round(e*.14),Y=Math.round(T+r*2.2),q=b=>String(b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),ot=Math.round(e*.09),X=Math.round(e*.11),nt=`
<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 ${e} ${e}">
  <defs>
    <linearGradient id="g" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="${h}" stop-opacity="1"/>
      <stop offset="1" stop-color="${h}" stop-opacity="0.88"/>
    </linearGradient>
  </defs>

  <!-- soft shadow -->
  <ellipse cx="${v}" cy="${Y+Math.round(e*.04)}" rx="${Math.round(r*1.25)}" ry="${Math.round(r*.6)}" fill="rgba(0,0,0,0.18)"/>

  <!-- teardrop pin (circle + pointed tail merged via path) -->
  <path d="M ${v} ${Y} L ${v+r} ${T} A ${r} ${r} 0 1 0 ${v-r} ${T} Z" fill="url(#g)"/>

  <!-- subtle highlight -->
  <ellipse cx="${v-Math.round(r*.35)}" cy="${T-Math.round(r*.35)}" rx="${Math.round(r*.45)}" ry="${Math.round(r*.25)}" fill="rgba(255,255,255,0.55)"/>

  <!-- inner white center -->
  <circle cx="${v}" cy="${T}" r="${Math.round(r*.45)}" fill="#fff"/>

  <!-- label below pin (up to 3 lines) -->
  <g font-family="sans-serif" font-size="${ot}" fill="#222" text-anchor="middle">
    ${o.slice(0,3).map((b,V)=>{const ft=Y+Math.round(X*.9)+V*X;return`<text x="${v}" y="${ft}">${q(b)}</text>`}).join("")}
  </g>
</svg>`.trim();return oe(nt,e,e)}D.useEffect(()=>{const e=i.current;if(!e)return;try{document.documentElement.style.margin="0",document.body.style.margin="0",document.documentElement.style.height="100%",document.body.style.height="100%"}catch{}e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="100vw",e.style.height="100vh",e.style.zIndex="0",At.current=document.body.style.overflow,Ot.current=document.body.style.background;try{document.body.style.background="linear-gradient(to bottom, #87CEEB 0%, #e0f7ff 100%)"}catch{}document.body.style.overflow="hidden";const h=new be;h.background=null;const P=e.clientWidth,p=e.clientHeight,o=new we(45,P/p,.1,1e3);o.position.set(0,20,40),s.current=o;const a=new pe({antialias:!1,alpha:!0});a.setSize(P,p),a.domElement.style.display="block",a.domElement.style.width="100%",a.domElement.style.height="100%",a.domElement.style.objectFit="cover",a.setPixelRatio(1),a.shadowMap.enabled=!1,a.setClearColor(0,0),d.current=a,e.appendChild(a.domElement);const v=new xe(16777215,.8);h.add(v);const T=new Ee(16777215,.6);T.position.set(10,20,10),h.add(T);const r=new ve(o,a.domElement);r.enableDamping=!1,r.target.set(0,5,0),r.minPolarAngle=0,r.maxPolarAngle=Math.PI/2-.01,r.screenSpacePanning=!1,n.current=r,window.__campus_camera=o,window.__campus_controls=r;let Y=!1,q=null;const ot=80;let X=0;const nt=()=>a.render(h,o);function b(){const l=performance.now(),z=Math.max(0,ot-(l-X));Y||(Y=!0,q=setTimeout(()=>{Y=!1,X=performance.now(),nt()},z))}window.__campus_requestRender=b,r.addEventListener("change",b);let V=null;function ft(l){function z(w=256){const L=document.createElement("canvas");L.width=w,L.height=w;const U=L.getContext("2d"),F=U.createRadialGradient(w/2,w/2,w*.05,w/2,w/2,w/2);F.addColorStop(0,"rgba(255,255,255,0.95)"),F.addColorStop(.6,"rgba(255,255,255,0.65)"),F.addColorStop(1,"rgba(255,255,255,0)"),U.fillStyle=F,U.fillRect(0,0,w,w);const J=new Kt(L);return J.needsUpdate=!0,J}V=new Ht;const at=z(256),St=Math.min(24,Math.max(6,Math.floor(l/8)));for(let w=0;w<St;w++){const L=new Wt({map:at,transparent:!0,opacity:0,depthWrite:!1}),U=new Zt(L),F=l*1.6;U.position.set((Math.random()-.5)*F,l*(.8+Math.random()*1),(Math.random()-.5)*F);const J=l*(.25+Math.random()*.6);U.scale.set(J,J*.6,1),V.add(U)}V.position.y=0,h.add(V);let st=0;const Q=60;let rt=performance.now();function W(){st++;const w=Math.min(1,st/Q);V.children.forEach((L,U)=>{L.material.opacity=w*(.6+U%3*.12);const F=performance.now(),J=(F-rt)/1e3;L.position.x+=Math.sin(F/1e4+U)*.02*J*Math.max(10,1)}),rt=performance.now(),a.render(h,o),st<Q&&requestAnimationFrame(W)}W()}C.current=new De,me("/models/psucampus.glb").then(l=>{t.current=l,h.add(l);const at=new ct().setFromObject(l).getCenter(new S);l.position.sub(at);const Q=new ct().setFromObject(l).getBoundingSphere(new Rt).radius||10;ft(Q);const rt=o.fov*Math.PI/180,W=Math.abs(Q/Math.sin(rt/2));o.position.set(0,Q*.6+W*.05,W*1.2),o.near=Math.max(.1,W/100),o.far=W*10,o.lookAt(new S(0,0,0)),o.updateProjectionMatrix(),r.target.set(0,0,0),r.update(),y.current=[];const L=new Map;let U=1;l.traverse(_=>{if(!_.isMesh)return;const G=new ct().setFromObject(_),B=new S;if(G.getSize(B),B.length()<.8)return;const R=_.userData?.buildingName,j=_.userData?.name,I=_.name&&_.name!==""?_.name:null,O=R||j||I||`Building ${U++}`;L.has(O)||L.set(O,[]),L.get(O).push(_)});const F=[];for(const[_,G]of L.entries()){const B=new ct;for(const A of G){const dt=new ct().setFromObject(A);B.union(dt)}const x=B.getCenter(new S),j=B.getBoundingSphere(new Rt).radius||Math.max(...G.map(A=>new ct().setFromObject(A).getSize(new S).length()))||5,I=Math.max(1,B.getSize(new S).y*.5+1),O=_;y.current.push({id:O,name:_,meshes:G,center:x,radius:j,offsetY:I}),F.push({id:O,name:_})}ht(F),b();try{const _=new Ht;_.renderOrder=999;const G=new Map;l.traverse(x=>{if(!x.isMesh)return;const R=Lt[x.name];if(!R)return;const j=new ct().setFromObject(x),O=j.getBoundingSphere(new Rt).radius||j.getSize(new S).length();if(!G.has(R))G.set(R,{nodes:[x],bbox:j.clone(),bestNode:x,bestMetric:O});else{const A=G.get(R);A.nodes.push(x),A.bbox.union(j),O>A.bestMetric&&(A.bestMetric=O,A.bestNode=x)}});for(const[x,R]of G.entries()){const j=R.bbox.getCenter(new S),I=Math.max(.6,(R.bestMetric||1)*.6),O=Dt[R.bestNode.name]||R.bestNode.userData?.buildingName||x,A=ne(256,"#ff5a5f",O),dt=new Wt({map:A,transparent:!0,depthTest:!1,depthWrite:!1,alphaTest:.01}),E=new Zt(dt);E.position.copy(j),E.position.y+=Math.max(.25,I*.6),E.scale.set(I,I,1),E.userData={isPin:!0,role:x,displayName:O,targetMesh:R.bestNode,meshes:R.nodes},E.renderOrder=1e3,E.frustumCulled=!1,_.add(E)}h.add(_);try{const x={"3DGeom-5559":"GENERAL EDUCATION DEPARTMENT Office","3DGeom-5586":"PRODUCTION and AUXILIARY SERVICES OFFICE"},R={},j=(E,ut)=>{const tt=(E.name||"")+" "+(E.userData?.buildingName||"")+" "+(E.userData?.name||""),c=String(tt).toLowerCase();if(c.includes("hmo")||c.includes("hospitality")||c.includes("management"))return"hmo";if(c.includes("boa")||c.includes("business")||c.includes("office administration"))return"boa";if(c.includes("it")||c.includes("information")||c.includes("technology"))return"it_dept";if(c.includes("ced")||c.includes("campus executive"))return"ced";if(c.includes("coa")||c.includes("college of agriculture")||c.includes("agriculture"))return"coa";if(c.includes("registrar"))return"registrar";if(c.includes("mis"))return"mis";if(c.includes("administrative")&&c.includes("office"))return"administrative_office";if(c.includes("supply"))return"supply_office";if(c.includes("account")||c.includes("accounting"))return"accounting_office";if(c.includes("cashier"))return"cashier_office";if(c.includes("library"))return"library_office";if(c.includes("guidance"))return"guidance_office";if(c.includes("student services")||c.includes("student_services")||c.includes("student service"))return"student_services_office";if(c.includes("supreme")||c.includes("student council")||c.includes("ssc"))return"supreme_student_council";if(c.includes("clinic")||c.includes("health"))return"clinic";if(ut&&ut!==E.name){const gt=(E.name||"").toLowerCase().replace(/[^a-z0-9_]+/g,"_");if(gt&&gt.length>2)return gt}return null},I=[],O={academic:["hmo","boa","it_dept","ced","coa"],administrative:["registrar","mis","administrative_office","supply_office","accounting_office","cashier_office","library_office"],sac:["guidance_office","student_services_office","supreme_student_council","clinic"],arts_science:["gened","paso"]},A={hmo:"1st Floor",boa:"3rd Floor",it_dept:"2nd Floor",ced:"2nd Floor",coa:"1st Floor",registrar:"1st Floor",mis:"1st Floor",administrative_office:"1st Floor",supply_office:"1st Floor",accounting_office:"1st Floor",cashier_office:"1st Floor",library_office:"2nd Floor",guidance_office:"2nd Floor",student_services_office:"2nd Floor",supreme_student_council:"2nd Floor",clinic:"1st Floor",gened:"1st Floor",paso:"1st Floor"},dt={hmo:"Hospitality Management Office",boa:"Business & Office Administration Department",it_dept:"Information Technology Department",ced:"Campus Executive Director Office",coa:"College of Agriculture",registrar:"Registrar's Office",mis:"Management Information Systems (MIS)",administrative_office:"Administrative Office",supply_office:"Supply Office",accounting_office:"Accounting Office",cashier_office:"Cashier",library_office:"Library",guidance_office:"Guidance Office",student_services_office:"Student Services Office",supreme_student_council:"Supreme Student Council",clinic:"Clinic / Health Center",gened:"General Education",paso:"Production and Auxiliary Services Office"};for(const[E,ut]of G.entries()){const tt=ut.bestNode,c={id:tt.name||tt.uuid,role:E,displayName:Dt[tt.name]||tt.userData?.buildingName||E,mesh:tt,meshes:ut.nodes,children:[]};if(["arts_science","academic","administrative","sac"].includes(E)){const gt=tt.name||tt.uuid,Bt=ut.nodes.map(g=>{const lt=g.name||g.uuid,et=R[lt]||j(g,E)||null,de=(et?dt[et]:null)||x[lt]||Dt[lt]||g.userData?.buildingName||g.userData?.name||lt,ue=A[et]||A[lt]||null;return{id:lt,displayName:de,role:et,floor:ue,mesh:g}}).filter(g=>g.id!==gt&&g.displayName&&g.displayName!==c.displayName),Pt=[...[...Bt.filter(g=>g.role),...Bt.filter(g=>!g.role)]],he=O[E]||[];for(const g of he)if(!Pt.some(et=>et.role===g||et.id===g)){const et=Qt[g]||{},Yt=dt[g]||et?.name||g;Pt.push({id:g,displayName:Yt,role:g,floor:A[g]||null,mesh:null})}c.children=Pt}I.push(c)}te(I)}catch(x){console.warn("Failed to collect pinned items:",x)}const B=window.__campus_requestRender;B&&B()}catch(_){console.warn("Failed to create pins:",_)}const J="3DGeom-5597",_t=y.current.find(_=>_.id===J);if(_t){it(_t.id);try{const _=_t.center.clone();_.y+=_t.offsetY||2;const G=_t.radius||5,B=o.fov*Math.PI/180,x=Math.abs(G/Math.sin(B/2))*1.2,R=new S(1,.6,1).normalize(),j=_.clone().add(R.multiplyScalar(x));o.position.copy(j),r.target.copy(_),r.update();const I=window.__campus_requestRender;I&&I()}catch{}}}).catch(l=>{console.error("Error loading model:",l)}),Me(a,o,()=>({children:[t.current,...h.children.filter(l=>l.renderOrder>=999)]}),(l,z,at)=>{if(!t.current)return;if(l.userData?.isPin){const rt=l.userData.role||null,W=l.userData.displayName||null;if(rt){It(rt,z,at,W?{name:W}:null),it(l.userData.targetMesh?.name||l.userData.targetMesh?.uuid);const w=window.__campus_requestRender;w&&w();return}}const st=Lt[l.name];if(!st)return;fetchInfoForRoleAndShowPopup(st,z,at,null),fetchHappeningsForShowPopup(st,z,at,null),it(l.name||l.uuid);const Q=window.__campus_requestRender;Q&&Q()});const Ut=()=>{const l=e.clientWidth,z=e.clientHeight;o.aspect=l/z,o.updateProjectionMatrix(),a.setSize(l,z)};return window.addEventListener("resize",Ut),b(),()=>{q&&clearTimeout(q);try{delete window.__campus_requestRender}catch{}window.removeEventListener("resize",Ut),r.removeEventListener("change",b);try{a.domElement.remove()}catch{}r.dispose(),a.dispose(),document.body.style.overflow=At.current;try{delete window.__campus_camera,delete window.__campus_controls}catch{}a.domElement&&a.domElement.parentNode&&a.domElement.parentNode.removeChild(a.domElement);try{document.body.style.background=Ot.current}catch{}}},[]);const ae=e=>{if(!(!e||!e.mesh))try{qt(e.mesh,{padding:Math.max(2,e.mesh.userData?.padding||2),animate:!0,frames:45},s,n,t),it(e.mesh.name||e.id);const h=window.__campus_requestRender;h&&h()}catch(h){console.warn("Fly to pin failed:",h)}},kt=e=>{if(e)try{if(e.role)It(e.role,window.innerWidth/2,window.innerHeight/2,{name:e.displayName}),it(e.mesh?.name||e.id);else{const P=Qt[e.id]||null;wt({id:e.id,name:P?.name||e.displayName||e.id,department:P?.department,description:P?.description,count:e.mesh?1:0,x:window.innerWidth/2,y:window.innerHeight/2}),it(e.id)}const h=window.__campus_requestRender;h&&h()}catch(h){console.warn("Open info failed:",h)}},N="#003366",K="#FFB81C",Nt="#E8F0F7",re={position:u?"fixed":"absolute",left:u?"50%":10,top:u?"auto":10,bottom:u?20:"auto",transform:u?"translateX(-50%)":"none",zIndex:30,background:N,color:"white",border:"none",padding:"10px 14px",borderRadius:8,cursor:"pointer",fontWeight:600,boxShadow:"0 4px 10px rgba(0,0,0,0.2)",width:u?"calc(100vw - 2.5rem)":"auto",maxWidth:u?420:"auto"},le={position:u?"fixed":"absolute",left:u?"50%":10,top:u?"auto":10,bottom:u?20:"auto",transform:u?"translateX(-50%)":"none",width:u?"calc(100vw - 2rem)":330,maxWidth:420,maxHeight:u?"60vh":"calc(100vh - 20px)",overflowY:"auto",padding:0,borderRadius:12,zIndex:20,background:"#ffffff",boxShadow:"0 10px 25px rgba(0, 51, 102, 0.15)",border:`2px solid ${N}`},ce={position:"fixed",right:u?"auto":0,left:u?0:"auto",bottom:u?0:"auto",top:u?"auto":0,width:u?"100%":340,maxWidth:u?"100%":360,height:u?"auto":"100vh",maxHeight:u?"80vh":"100vh",background:"rgba(255,255,255,0.98)",boxShadow:u?"0 -8px 20px rgba(0,0,0,0.2)":"2px 0 16px rgba(0,0,0,0.10)",zIndex:60,padding:u?"16px 20px":24,overflowY:"auto",transition:"transform 0.3s ease",transform:Z?u?"translateY(0)":"translateX(0)":u?"translateY(110%)":"translateX(110%)",pointerEvents:Z?"auto":"none",borderRadius:u?"16px 16px 0 0":0,display:"flex",flexDirection:"column"};return m.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[m.jsx("div",{ref:i}),!jt&&m.jsx("button",{onClick:()=>xt(!0),style:re,children:"Show Buildings"}),jt&&m.jsxs("div",{style:le,children:[m.jsx("div",{style:{background:`linear-gradient(135deg, ${N} 0%, ${N}dd 100%)`,padding:"16px 20px",borderRadius:"10px 10px 0 0",borderBottom:`3px solid ${K}`},children:m.jsxs("div",{style:{fontWeight:700,color:K,fontSize:16,letterSpacing:.5,display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[m.jsx(Pe,{size:20,color:K}),"PSU BUILDINGS"]}),m.jsx("button",{onClick:()=>xt(!1),className:"text-gray-400 hover:text-gray-200 text-sm",children:"✕"})]})}),m.jsx("div",{style:{padding:"12px",display:"flex",flexDirection:"column",gap:10},children:Ct.length===0?m.jsx("div",{style:{color:"#999",fontSize:13,textAlign:"center",padding:"20px 10px"},children:"Loading campus buildings..."}):Ct.map(e=>{const h=!!ee[e.id],P=bt===(e.mesh?.name||e.id);return m.jsxs("div",{children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:P?Nt:"#f8f9fa",padding:"10px 12px",borderRadius:8,border:P?`2px solid ${N}`:"1px solid #e0e0e0",transition:"all 0.2s ease"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:[e.children&&e.children.length>0&&m.jsx("button",{onClick:()=>se(p=>({...p,[e.id]:!p[e.id]})),style:{border:"none",background:"transparent",cursor:"pointer",padding:4,fontSize:14,color:N,transition:"transform 0.2s",transform:h?"rotate(180deg)":"rotate(0)"},"aria-label":h?"Collapse":"Expand",children:"▾"}),!e.children||e.children.length===0&&m.jsx("div",{style:{width:24}}),m.jsx("div",{style:{flex:1},children:m.jsx("div",{style:{fontSize:13,fontWeight:600,color:N},children:e.displayName})})]}),m.jsx("div",{style:{display:"flex",gap:6},children:m.jsx("button",{onClick:()=>{ae(e),kt(e)},style:{background:N,color:"#fff",border:"none",padding:"6px 12px",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:600,transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 51, 102, 0.2)"},onMouseEnter:p=>{p.target.style.background=K,p.target.style.color=N},onMouseLeave:p=>{p.target.style.background=N,p.target.style.color="#fff"},children:"View"})})]}),e.children&&e.children.length>0&&h&&m.jsx("div",{style:{marginTop:8,marginLeft:0,display:"flex",flexDirection:"column",gap:6,paddingLeft:12,borderLeft:`3px solid ${K}`},children:e.children.map(p=>m.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:6,background:"#f0f4f8",border:"1px solid #d0d9e8",transition:"all 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.background=Nt,o.currentTarget.style.borderColor=K},onMouseLeave:o=>{o.currentTarget.style.background="#f0f4f8",o.currentTarget.style.borderColor="#d0d9e8"},children:[m.jsx("div",{style:{flex:1},children:m.jsx("div",{style:{fontSize:12,color:"#333",fontWeight:500},children:p.floor?`${p.displayName} - ${p.floor}`:p.displayName})}),m.jsx("button",{onClick:()=>kt(p),style:{background:K,color:N,border:"none",padding:"4px 8px",borderRadius:4,cursor:"pointer",fontSize:11,fontWeight:600,transition:"all 0.2s ease"},onMouseEnter:o=>{o.target.style.background=N,o.target.style.color=K},onMouseLeave:o=>{o.target.style.background=K,o.target.style.color=N},children:"Info"})]},p.id))})]},e.id)})})]}),m.jsx("div",{style:ce,children:Z&&m.jsx(Re,{popupInfo:Z,onClose:()=>{wt(null),it(null)},onFlyTo:()=>{if(!Z)return;const e=y.current.find(h=>h.id===Z.id);e?Se(e,s,n):Z._mesh&&qt(Z._mesh,{padding:Z._meshRadius||2,animate:!0,frames:45},s,n,t),wt(null)}})}),m.jsx("div",{"aria-label":"Camera controls",style:{position:"fixed",right:20,bottom:20,width:120,height:120,display:"flex",alignItems:"center",justifyContent:"center",zIndex:40,pointerEvents:"auto"}})]})}export{qe as default};
