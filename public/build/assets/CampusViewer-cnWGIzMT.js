import{r as x,j as p,a as gt}from"./app-Dx9GpVgR.js";import{W as de,l as ue}from"./ModelLoader-Bj-44Cu6.js";import{C as pe,a as D,M as pt,T as ut,Q as Yt,b as zt,V as $,c as me,P as fe,d as _e,e as ge,f as ye,A as be,D as we,R as xe,B as ct,S as Pt,G as Ht,g as $t,h as Wt,i as Zt}from"./three.core-BXuiQTOK.js";import{setupRaycaster as Ee}from"./RaycasterManager-DpyK2-wN.js";import{flyToTargetSafe as De,flyToMeshSafe as Kt}from"./ControlsManager-DOTcoOXg.js";import{M as Me,I as Se}from"./InfoPopup-C_DLYNJL.js";const qt={type:"change"},Tt={type:"start"},Qt={type:"end"},xt=new me,Xt=new fe,Pe=Math.cos(70*_e.DEG2RAD),E=new D,N=2*Math.PI,m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Rt=1e-6;class Re extends pe{constructor(t,s=null){super(t,s),this.state=m.NONE,this.target=new D,this.cursor=new D,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:pt.ROTATE,MIDDLE:pt.DOLLY,RIGHT:pt.PAN},this.touches={ONE:ut.ROTATE,TWO:ut.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new D,this._lastQuaternion=new Yt,this._lastTargetPosition=new D,this._quat=new Yt().setFromUnitVectors(t.up,new D(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new zt,this._sphericalDelta=new zt,this._scale=1,this._panOffset=new D,this._rotateStart=new $,this._rotateEnd=new $,this._rotateDelta=new $,this._panStart=new $,this._panEnd=new $,this._panDelta=new $,this._dollyStart=new $,this._dollyEnd=new $,this._dollyDelta=new $,this._dollyDirection=new D,this._mouse=new $,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=ve.bind(this),this._onPointerDown=Te.bind(this),this._onPointerUp=Ce.bind(this),this._onContextMenu=Ne.bind(this),this._onMouseWheel=Le.bind(this),this._onKeyDown=je.bind(this),this._onTouchStart=Ie.bind(this),this._onTouchMove=ke.bind(this),this._onMouseDown=Oe.bind(this),this._onMouseMove=Ae.bind(this),this._interceptControlDown=Ge.bind(this),this._interceptControlUp=Ue.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(qt),this.update(),this.state=m.NONE}update(t=null){const s=this.object.position;E.copy(s).sub(this.target),E.applyQuaternion(this._quat),this._spherical.setFromVector3(E),this.autoRotate&&this.state===m.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,d=this.maxAzimuthAngle;isFinite(n)&&isFinite(d)&&(n<-Math.PI?n+=N:n>Math.PI&&(n-=N),d<-Math.PI?d+=N:d>Math.PI&&(d-=N),n<=d?this._spherical.theta=Math.max(n,Math.min(d,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+d)/2?Math.max(n,this._spherical.theta):Math.min(d,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let g=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const v=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),g=v!=this._spherical.radius}if(E.setFromSpherical(this._spherical),E.applyQuaternion(this._quatInverse),s.copy(this.target).add(E),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let v=null;if(this.object.isPerspectiveCamera){const W=E.length();v=this._clampDistance(W*this._scale);const ht=W-v;this.object.position.addScaledVector(this._dollyDirection,ht),this.object.updateMatrixWorld(),g=!!ht}else if(this.object.isOrthographicCamera){const W=new D(this._mouse.x,this._mouse.y,0);W.unproject(this.object);const ht=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),g=ht!==this.object.zoom;const yt=new D(this._mouse.x,this._mouse.y,0);yt.unproject(this.object),this.object.position.sub(yt).add(W),this.object.updateMatrixWorld(),v=E.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;v!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(v).add(this.object.position):(xt.origin.copy(this.object.position),xt.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(xt.direction))<Pe?this.object.lookAt(this.target):(Xt.setFromNormalAndCoplanarPoint(this.object.up,this.target),xt.intersectPlane(Xt,this.target))))}else if(this.object.isOrthographicCamera){const v=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),v!==this.object.zoom&&(this.object.updateProjectionMatrix(),g=!0)}return this._scale=1,this._performCursorZoom=!1,g||this._lastPosition.distanceToSquared(this.object.position)>Rt||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Rt||this._lastTargetPosition.distanceToSquared(this.target)>Rt?(this.dispatchEvent(qt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?N/60*this.autoRotateSpeed*t:N/60/60*this.autoRotateSpeed}_getZoomScale(t){const s=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*s)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,s){E.setFromMatrixColumn(s,0),E.multiplyScalar(-t),this._panOffset.add(E)}_panUp(t,s){this.screenSpacePanning===!0?E.setFromMatrixColumn(s,1):(E.setFromMatrixColumn(s,0),E.crossVectors(this.object.up,E)),E.multiplyScalar(t),this._panOffset.add(E)}_pan(t,s){const n=this.domElement;if(this.object.isPerspectiveCamera){const d=this.object.position;E.copy(d).sub(this.target);let g=E.length();g*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*g/n.clientHeight,this.object.matrix),this._panUp(2*s*g/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(s*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,s){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),d=t-n.left,g=s-n.top,v=n.width,W=n.height;this._mouse.x=d/v*2-1,this._mouse.y=-(g/W)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(N*this._rotateDelta.x/s.clientHeight),this._rotateUp(N*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let s=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(N*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),s=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-N*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),s=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(N*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),s=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-N*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),s=!0;break}s&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._rotateStart.set(n,d)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._panStart.set(n,d)}}_handleTouchStartDolly(t){const s=this._getSecondPointerPosition(t),n=t.pageX-s.x,d=t.pageY-s.y,g=Math.sqrt(n*n+d*d);this._dollyStart.set(0,g)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),d=.5*(t.pageX+n.x),g=.5*(t.pageY+n.y);this._rotateEnd.set(d,g)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(N*this._rotateDelta.x/s.clientHeight),this._rotateUp(N*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),n=.5*(t.pageX+s.x),d=.5*(t.pageY+s.y);this._panEnd.set(n,d)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const s=this._getSecondPointerPosition(t),n=t.pageX-s.x,d=t.pageY-s.y,g=Math.sqrt(n*n+d*d);this._dollyEnd.set(0,g),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const v=(t.pageX+s.x)*.5,W=(t.pageY+s.y)*.5;this._updateZoomParameters(v,W)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId){this._pointers.splice(s,1);return}}_isTrackingPointer(t){for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId)return!0;return!1}_trackPointer(t){let s=this._pointerPositions[t.pointerId];s===void 0&&(s=new $,this._pointerPositions[t.pointerId]=s),s.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const s=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[s]}_customWheelEvent(t){const s=t.deltaMode,n={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(s){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function Te(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function ve(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function Ce(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Qt),this.state=m.NONE;break;case 1:const t=this._pointers[0],s=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:s.x,pageY:s.y});break}}function Oe(i){let t;switch(i.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case pt.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=m.DOLLY;break;case pt.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=m.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=m.ROTATE}break;case pt.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=m.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=m.PAN}break;default:this.state=m.NONE}this.state!==m.NONE&&this.dispatchEvent(Tt)}function Ae(i){switch(this.state){case m.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case m.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case m.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function Le(i){this.enabled===!1||this.enableZoom===!1||this.state!==m.NONE||(i.preventDefault(),this.dispatchEvent(Tt),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(Qt))}function je(i){this.enabled!==!1&&this._handleKeyDown(i)}function Ie(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case ut.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=m.TOUCH_ROTATE;break;case ut.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=m.TOUCH_PAN;break;default:this.state=m.NONE}break;case 2:switch(this.touches.TWO){case ut.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=m.TOUCH_DOLLY_PAN;break;case ut.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=m.TOUCH_DOLLY_ROTATE;break;default:this.state=m.NONE}break;default:this.state=m.NONE}this.state!==m.NONE&&this.dispatchEvent(Tt)}function ke(i){switch(this._trackPointer(i),this.state){case m.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case m.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case m.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case m.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=m.NONE}}function Ne(i){this.enabled!==!1&&i.preventDefault()}function Ge(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Ue(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Vt={"3DGeom-1078":{name:"Information Technology Building",department:"College of Information Technology",description:"This building houses computer labs, lecture rooms, and faculty offices for the IT Department."}};function Ze(){const i=x.useRef(null),t=x.useRef(null),s=x.useRef(null),n=x.useRef(null),d=x.useRef(null),g=x.useRef([]),v=x.useRef(null),[W,ht]=x.useState([]),[yt,ot]=x.useState(null),[K,bt]=x.useState(null),[vt,Jt]=x.useState([]),[te,ee]=x.useState({}),Ct=x.useRef(document.body.style.background),Ot=x.useRef(document.body.style.overflow),At={"3DGeom-5559":"arts_science","3DGeom-10191":"administrative","3DGeom-5890":"education","3DGeom-5891":"education","3DGeom-9084":"sac","3DGeom-4166":"cayetano","3DGeom-4179":"cayetano","3DGeom-4173":"cayetano","3DGeom-3337":"audiovisual","3DGeom-3332":"audiovisual","3DGeom-4309":"agri","3DGeom-4308":"agri","3DGeom-6523":"cc","3DGeom-6071":"cc","3DGeom-6255":"cc","3DGeom-1104":"academic","3DGeom-3177":"twinbldg","3DGeom-9669":"hm_lb","3DGeom-5597":"admin"},Et={"3DGeom-5559":"Arts and Science Building","3DGeom-10191":"Administrative Building","3DGeom-5890":"Education Building","3DGeom-5891":"Education Building","3DGeom-9084":"Student Activity Center","3DGeom-4166":"Cayetano Building","3DGeom-4179":"Cayetano Building","3DGeom-4173":"Cayetano Building","3DGeom-3337":"Audio Visual Building","3DGeom-3332":"Audio Visual Building","3DGeom-4309":"Agriculture Building","3DGeom-4308":"Agriculture Building","3DGeom-6523":"Covered Court","3DGeom-6071":"Covered Court","3DGeom-6255":"Covered Court","3DGeom-1104":"Academic Building","3DGeom-3177":"Twin Building","3DGeom-9669":"HM Lab Building","3DGeom-5597":"General Update"},Dt=()=>typeof window<"u"?window.innerWidth<768:!1,[u,se]=x.useState(Dt),[Lt,wt]=x.useState(()=>!Dt());x.useEffect(()=>{if(typeof window>"u")return;const e=()=>se(Dt());return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),x.useEffect(()=>{wt(!u)},[u]);const jt=async(e,h,M,_=null)=>{try{const[o,a,T,R,r]=await Promise.all([gt.get(`/info-building/${e}`),gt.get(`/happenings/${e}`),gt.get(`/services/${e}`),gt.get(`/achievements/${e}`),gt.get(`/announcements/${e}`)]),z=Array.isArray(o.data)?o.data:o.data?[o.data]:[],X=Array.isArray(a.data)?a.data:a.data?[a.data]:[],nt=Array.isArray(T.data)?T.data:T.data?[T.data]:[],V=Array.isArray(R.data)?R.data:R.data?[R.data]:[],at=Array.isArray(r.data)?r.data:r.data?[r.data]:[],S=z,Q=X,mt=nt,Nt=V,Gt=at;bt({id:e,name:S.name||_?.name||e.toUpperCase(),department:e.toUpperCase(),happenings:Q,services:mt,achievements:Nt,announcements:Gt,infoDetails:S,infoCount:z.length,happCount:X.length,serviceCount:nt.length,achievementCount:V.length,announcementCount:at.length,x:h,y:M,_rawInfo:z,_rawHappenings:X,_rawServices:nt,_rawAchievements:V,_rawAnnouncements:at})}catch(o){console.error("Error fetching popup data:",o)}};function ie(e,h=256,M=256){const _=document.createElement("canvas");_.width=h,_.height=M;const o=_.getContext("2d");o.clearRect(0,0,h,M);const a=new Zt(_),T=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),R=URL.createObjectURL(T),r=new Image;return r.onload=()=>{o.clearRect(0,0,h,M),o.drawImage(r,0,0,h,M),a.needsUpdate=!0,URL.revokeObjectURL(R)},r.onerror=()=>{a.needsUpdate=!0,URL.revokeObjectURL(R)},r.src=R,a}function oe(e=256,h="#ce1319ff",M=""){const _=(M||"").split(/\s+/).filter(Boolean),o=[];let a="";for(let S of _)a?(a+" "+S).length>12&&o.length<2?(o.push(a),a=S):a=a?a+" "+S:S:a=S;for(a&&o.push(a);o.length<1;)o.push("");const T=Math.round(e/2),R=Math.round(e*.36),r=Math.round(e*.14),z=Math.round(R+r*2.2),X=S=>String(S).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),nt=Math.round(e*.09),V=Math.round(e*.11),at=`
<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 ${e} ${e}">
  <defs>
    <linearGradient id="g" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="${h}" stop-opacity="1"/>
      <stop offset="1" stop-color="${h}" stop-opacity="0.88"/>
    </linearGradient>
  </defs>

  <!-- soft shadow -->
  <ellipse cx="${T}" cy="${z+Math.round(e*.04)}" rx="${Math.round(r*1.25)}" ry="${Math.round(r*.6)}" fill="rgba(0,0,0,0.18)"/>

  <!-- teardrop pin (circle + pointed tail merged via path) -->
  <path d="M ${T} ${z} L ${T+r} ${R} A ${r} ${r} 0 1 0 ${T-r} ${R} Z" fill="url(#g)"/>

  <!-- subtle highlight -->
  <ellipse cx="${T-Math.round(r*.35)}" cy="${R-Math.round(r*.35)}" rx="${Math.round(r*.45)}" ry="${Math.round(r*.25)}" fill="rgba(255,255,255,0.55)"/>

  <!-- inner white center -->
  <circle cx="${T}" cy="${R}" r="${Math.round(r*.45)}" fill="#fff"/>

  <!-- label below pin (up to 3 lines) -->
  <g font-family="sans-serif" font-size="${nt}" fill="#222" text-anchor="middle">
    ${o.slice(0,3).map((S,Q)=>{const mt=z+Math.round(V*.9)+Q*V;return`<text x="${T}" y="${mt}">${X(S)}</text>`}).join("")}
  </g>
</svg>`.trim();return ie(at,e,e)}x.useEffect(()=>{const e=i.current;if(!e)return;try{document.documentElement.style.margin="0",document.body.style.margin="0",document.documentElement.style.height="100%",document.body.style.height="100%"}catch{}e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="100vw",e.style.height="100vh",e.style.zIndex="0",Ot.current=document.body.style.overflow,Ct.current=document.body.style.background;try{document.body.style.background="linear-gradient(to bottom, #87CEEB 0%, #e0f7ff 100%)"}catch{}document.body.style.overflow="hidden";const h=new ge;h.background=null;const M=e.clientWidth,_=e.clientHeight,o=new ye(45,M/_,.1,1e3);o.position.set(0,20,40),s.current=o;const a=new de({antialias:!1,alpha:!0});a.setSize(M,_),a.domElement.style.display="block",a.domElement.style.width="100%",a.domElement.style.height="100%",a.domElement.style.objectFit="cover",a.setPixelRatio(1),a.shadowMap.enabled=!1,a.setClearColor(0,0),d.current=a,e.appendChild(a.domElement);const T=new be(16777215,.8);h.add(T);const R=new we(16777215,.6);R.position.set(10,20,10),h.add(R);const r=new Re(o,a.domElement);r.enableDamping=!1,r.target.set(0,5,0),r.minPolarAngle=0,r.maxPolarAngle=Math.PI/2-.01,r.screenSpacePanning=!1,n.current=r,window.__campus_camera=o,window.__campus_controls=r;let z=!1,X=null;const nt=80;let V=0;const at=()=>a.render(h,o);function S(){const l=performance.now(),H=Math.max(0,nt-(l-V));z||(z=!0,X=setTimeout(()=>{z=!1,V=performance.now(),at()},H))}window.__campus_requestRender=S,r.addEventListener("change",S);let Q=null;function mt(l){function H(b=256){const A=document.createElement("canvas");A.width=b,A.height=b;const B=A.getContext("2d"),U=B.createRadialGradient(b/2,b/2,b*.05,b/2,b/2,b/2);U.addColorStop(0,"rgba(255,255,255,0.95)"),U.addColorStop(.6,"rgba(255,255,255,0.65)"),U.addColorStop(1,"rgba(255,255,255,0)"),B.fillStyle=U,B.fillRect(0,0,b,b);const tt=new Zt(A);return tt.needsUpdate=!0,tt}Q=new Ht;const rt=H(256),Mt=Math.min(24,Math.max(6,Math.floor(l/8)));for(let b=0;b<Mt;b++){const A=new $t({map:rt,transparent:!0,opacity:0,depthWrite:!1}),B=new Wt(A),U=l*1.6;B.position.set((Math.random()-.5)*U,l*(.8+Math.random()*1),(Math.random()-.5)*U);const tt=l*(.25+Math.random()*.6);B.scale.set(tt,tt*.6,1),Q.add(B)}Q.position.y=0,h.add(Q);let st=0;const J=60;let lt=performance.now();function Z(){st++;const b=Math.min(1,st/J);Q.children.forEach((A,B)=>{A.material.opacity=b*(.6+B%3*.12);const U=performance.now(),tt=(U-lt)/1e3;A.position.x+=Math.sin(U/1e4+B)*.02*tt*Math.max(10,1)}),lt=performance.now(),a.render(h,o),st<J&&requestAnimationFrame(Z)}Z()}v.current=new xe,ue("/models/psucampus.glb").then(l=>{t.current=l,h.add(l);const rt=new ct().setFromObject(l).getCenter(new D);l.position.sub(rt);const J=new ct().setFromObject(l).getBoundingSphere(new Pt).radius||10;mt(J);const lt=o.fov*Math.PI/180,Z=Math.abs(J/Math.sin(lt/2));o.position.set(0,J*.6+Z*.05,Z*1.2),o.near=Math.max(.1,Z/100),o.far=Z*10,o.lookAt(new D(0,0,0)),o.updateProjectionMatrix(),r.target.set(0,0,0),r.update(),g.current=[];const A=new Map;let B=1;l.traverse(f=>{if(!f.isMesh)return;const F=new ct().setFromObject(f),Y=new D;if(F.getSize(Y),Y.length()<.8)return;const P=f.userData?.buildingName,L=f.userData?.name,j=f.name&&f.name!==""?f.name:null,C=P||L||j||`Building ${B++}`;A.has(C)||A.set(C,[]),A.get(C).push(f)});const U=[];for(const[f,F]of A.entries()){const Y=new ct;for(const I of F){const O=new ct().setFromObject(I);Y.union(O)}const w=Y.getCenter(new D),L=Y.getBoundingSphere(new Pt).radius||Math.max(...F.map(I=>new ct().setFromObject(I).getSize(new D).length()))||5,j=Math.max(1,Y.getSize(new D).y*.5+1),C=f;g.current.push({id:C,name:f,meshes:F,center:w,radius:L,offsetY:j}),U.push({id:C,name:f})}ht(U),S();try{const f=new Ht;f.renderOrder=999;const F=new Map;l.traverse(w=>{if(!w.isMesh)return;const P=At[w.name];if(!P)return;const L=new ct().setFromObject(w),C=L.getBoundingSphere(new Pt).radius||L.getSize(new D).length();if(!F.has(P))F.set(P,{nodes:[w],bbox:L.clone(),bestNode:w,bestMetric:C});else{const I=F.get(P);I.nodes.push(w),I.bbox.union(L),C>I.bestMetric&&(I.bestMetric=C,I.bestNode=w)}});for(const[w,P]of F.entries()){const L=P.bbox.getCenter(new D),j=Math.max(.6,(P.bestMetric||1)*.6),C=Et[P.bestNode.name]||P.bestNode.userData?.buildingName||w,I=oe(256,"#ff5a5f",C),O=new $t({map:I,transparent:!0,depthTest:!1,depthWrite:!1,alphaTest:.01}),k=new Wt(O);k.position.copy(L),k.position.y+=Math.max(.25,j*.6),k.scale.set(j,j,1),k.userData={isPin:!0,role:w,displayName:C,targetMesh:P.bestNode,meshes:P.nodes},k.renderOrder=1e3,k.frustumCulled=!1,f.add(k)}h.add(f);try{const w={"3DGeom-5559":"GENERAL EDUCATION DEPARTMENT Office","3DGeom-5586":"PRODUCTION and AUXILIARY SERVICES OFFICE"},P={},L=(O,k)=>{const et=(O.name||"")+" "+(O.userData?.buildingName||"")+" "+(O.userData?.name||""),c=String(et).toLowerCase();if(c.includes("hmo")||c.includes("hospitality")||c.includes("management"))return"hmo";if(c.includes("boa")||c.includes("business")||c.includes("office administration"))return"boa";if(c.includes("it")||c.includes("information")||c.includes("technology"))return"it_dept";if(c.includes("ced")||c.includes("campus executive"))return"ced";if(c.includes("coa")||c.includes("college of agriculture")||c.includes("agriculture"))return"coa";if(c.includes("registrar"))return"registrar";if(c.includes("mis"))return"mis";if(c.includes("administrative")&&c.includes("office"))return"administrative_office";if(c.includes("supply"))return"supply_office";if(c.includes("account")||c.includes("accounting"))return"accounting_office";if(c.includes("cashier"))return"cashier_office";if(c.includes("library"))return"library_office";if(c.includes("guidance"))return"guidance_office";if(c.includes("student services")||c.includes("student_services")||c.includes("student service"))return"student_services_office";if(c.includes("supreme")||c.includes("student council")||c.includes("ssc"))return"supreme_student_council";if(c.includes("clinic")||c.includes("health"))return"clinic";if(k&&k!==O.name){const _t=(O.name||"").toLowerCase().replace(/[^a-z0-9_]+/g,"_");if(_t&&_t.length>2)return _t}return null},j=[],C={academic:["hmo","boa","it_dept","ced","coa"],administrative:["registrar","mis","administrative_office","supply_office","accounting_office","cashier_office","library_office"],sac:["guidance_office","student_services_office","supreme_student_council","clinic"],arts_science:["gened","paso"]},I={hmo:"Hospitality Management Office",boa:"Business & Office Administration Department",it_dept:"Information Technology Department",ced:"Campus Executive Director Office",coa:"College of Agriculture",registrar:"Registrar's Office",mis:"Management Information Systems (MIS)",administrative_office:"Administrative Office",supply_office:"Supply Office",accounting_office:"Accounting Office",cashier_office:"Cashier",library_office:"Library",guidance_office:"Guidance Office",student_services_office:"Student Services Office",supreme_student_council:"Supreme Student Council",clinic:"Clinic / Health Center",gened:"General Education",paso:"Production and Auxiliary Services Office"};for(const[O,k]of F.entries()){const et=k.bestNode,c={id:et.name||et.uuid,role:O,displayName:Et[et.name]||et.userData?.buildingName||O,mesh:et,meshes:k.nodes,children:[]};if(["arts_science","academic","administrative","sac"].includes(O)){const _t=et.name||et.uuid,Ft=k.nodes.map(y=>{const dt=y.name||y.uuid,it=P[dt]||L(y,O)||null,he=(it?I[it]:null)||w[dt]||Et[dt]||y.userData?.buildingName||y.userData?.name||dt;return{id:dt,displayName:he,role:it,mesh:y}}).filter(y=>y.id!==_t&&y.displayName&&y.displayName!==c.displayName),St=[...[...Ft.filter(y=>y.role),...Ft.filter(y=>!y.role)]],ce=C[O]||[];for(const y of ce)if(!St.some(it=>it.role===y||it.id===y)){const it=Vt[y]||{},Bt=I[y]||it?.name||y;St.push({id:y,displayName:Bt,role:y,mesh:null})}c.children=St}j.push(c)}Jt(j)}catch(w){console.warn("Failed to collect pinned items:",w)}const Y=window.__campus_requestRender;Y&&Y()}catch(f){console.warn("Failed to create pins:",f)}const tt="3DGeom-5597",ft=g.current.find(f=>f.id===tt);if(ft){ot(ft.id);try{const f=ft.center.clone();f.y+=ft.offsetY||2;const F=ft.radius||5,Y=o.fov*Math.PI/180,w=Math.abs(F/Math.sin(Y/2))*1.2,P=new D(1,.6,1).normalize(),L=f.clone().add(P.multiplyScalar(w));o.position.copy(L),r.target.copy(f),r.update();const j=window.__campus_requestRender;j&&j()}catch{}}}).catch(l=>{console.error("Error loading model:",l)}),Ee(a,o,()=>({children:[t.current,...h.children.filter(l=>l.renderOrder>=999)]}),(l,H,rt)=>{if(!t.current)return;if(l.userData?.isPin){const lt=l.userData.role||null,Z=l.userData.displayName||null;if(lt){jt(lt,H,rt,Z?{name:Z}:null),ot(l.userData.targetMesh?.name||l.userData.targetMesh?.uuid);const b=window.__campus_requestRender;b&&b();return}}const st=At[l.name];if(!st)return;fetchInfoForRoleAndShowPopup(st,H,rt,null),fetchHappeningsForShowPopup(st,H,rt,null),ot(l.name||l.uuid);const J=window.__campus_requestRender;J&&J()});const Ut=()=>{const l=e.clientWidth,H=e.clientHeight;o.aspect=l/H,o.updateProjectionMatrix(),a.setSize(l,H)};return window.addEventListener("resize",Ut),S(),()=>{X&&clearTimeout(X);try{delete window.__campus_requestRender}catch{}window.removeEventListener("resize",Ut),r.removeEventListener("change",S);try{a.domElement.remove()}catch{}r.dispose(),a.dispose(),document.body.style.overflow=Ot.current;try{delete window.__campus_camera,delete window.__campus_controls}catch{}a.domElement&&a.domElement.parentNode&&a.domElement.parentNode.removeChild(a.domElement);try{document.body.style.background=Ct.current}catch{}}},[]);const ne=e=>{if(!(!e||!e.mesh))try{Kt(e.mesh,{padding:Math.max(2,e.mesh.userData?.padding||2),animate:!0,frames:45},s,n,t),ot(e.mesh.name||e.id);const h=window.__campus_requestRender;h&&h()}catch(h){console.warn("Fly to pin failed:",h)}},It=e=>{if(e)try{if(e.role)jt(e.role,window.innerWidth/2,window.innerHeight/2,{name:e.displayName}),ot(e.mesh?.name||e.id);else{const M=Vt[e.id]||null;bt({id:e.id,name:M?.name||e.displayName||e.id,department:M?.department,description:M?.description,count:e.mesh?1:0,x:window.innerWidth/2,y:window.innerHeight/2}),ot(e.id)}const h=window.__campus_requestRender;h&&h()}catch(h){console.warn("Open info failed:",h)}},G="#003366",q="#FFB81C",kt="#E8F0F7",ae={position:u?"fixed":"absolute",left:u?"50%":10,top:u?"auto":10,bottom:u?20:"auto",transform:u?"translateX(-50%)":"none",zIndex:30,background:G,color:"white",border:"none",padding:"10px 14px",borderRadius:8,cursor:"pointer",fontWeight:600,boxShadow:"0 4px 10px rgba(0,0,0,0.2)",width:u?"calc(100vw - 2.5rem)":"auto",maxWidth:u?420:"auto"},re={position:u?"fixed":"absolute",left:u?"50%":10,top:u?"auto":10,bottom:u?20:"auto",transform:u?"translateX(-50%)":"none",width:u?"calc(100vw - 2rem)":330,maxWidth:420,maxHeight:u?"60vh":"calc(100vh - 20px)",overflowY:"auto",padding:0,borderRadius:12,zIndex:20,background:"#ffffff",boxShadow:"0 10px 25px rgba(0, 51, 102, 0.15)",border:`2px solid ${G}`},le={position:"fixed",right:u?"auto":0,left:u?0:"auto",bottom:u?0:"auto",top:u?"auto":0,width:u?"100%":340,maxWidth:u?"100%":360,height:u?"auto":"100vh",maxHeight:u?"80vh":"100vh",background:"rgba(255,255,255,0.98)",boxShadow:u?"0 -8px 20px rgba(0,0,0,0.2)":"2px 0 16px rgba(0,0,0,0.10)",zIndex:60,padding:u?"16px 20px":24,overflowY:"auto",transition:"transform 0.3s ease",transform:K?u?"translateY(0)":"translateX(0)":u?"translateY(110%)":"translateX(110%)",pointerEvents:K?"auto":"none",borderRadius:u?"16px 16px 0 0":0,display:"flex",flexDirection:"column"};return p.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[p.jsx("div",{ref:i}),!Lt&&p.jsx("button",{onClick:()=>wt(!0),style:ae,children:"Show Buildings"}),Lt&&p.jsxs("div",{style:re,children:[p.jsx("div",{style:{background:`linear-gradient(135deg, ${G} 0%, ${G}dd 100%)`,padding:"16px 20px",borderRadius:"10px 10px 0 0",borderBottom:`3px solid ${q}`},children:p.jsxs("div",{style:{fontWeight:700,color:q,fontSize:16,letterSpacing:.5,display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[p.jsx(Me,{size:20,color:q}),"PSU BUILDINGS"]}),p.jsx("button",{onClick:()=>wt(!1),className:"text-gray-400 hover:text-gray-200 text-sm",children:"✕"})]})}),p.jsx("div",{style:{padding:"12px",display:"flex",flexDirection:"column",gap:10},children:vt.length===0?p.jsx("div",{style:{color:"#999",fontSize:13,textAlign:"center",padding:"20px 10px"},children:"Loading campus buildings..."}):vt.map(e=>{const h=!!te[e.id],M=yt===(e.mesh?.name||e.id);return p.jsxs("div",{children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:M?kt:"#f8f9fa",padding:"10px 12px",borderRadius:8,border:M?`2px solid ${G}`:"1px solid #e0e0e0",transition:"all 0.2s ease"},children:[p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:[e.children&&e.children.length>0&&p.jsx("button",{onClick:()=>ee(_=>({..._,[e.id]:!_[e.id]})),style:{border:"none",background:"transparent",cursor:"pointer",padding:4,fontSize:14,color:G,transition:"transform 0.2s",transform:h?"rotate(180deg)":"rotate(0)"},"aria-label":h?"Collapse":"Expand",children:"▾"}),!e.children||e.children.length===0&&p.jsx("div",{style:{width:24}}),p.jsx("div",{style:{flex:1},children:p.jsx("div",{style:{fontSize:13,fontWeight:600,color:G},children:e.displayName})})]}),p.jsx("div",{style:{display:"flex",gap:6},children:p.jsx("button",{onClick:()=>{ne(e),It(e)},style:{background:G,color:"#fff",border:"none",padding:"6px 12px",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:600,transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 51, 102, 0.2)"},onMouseEnter:_=>{_.target.style.background=q,_.target.style.color=G},onMouseLeave:_=>{_.target.style.background=G,_.target.style.color="#fff"},children:"View"})})]}),e.children&&e.children.length>0&&h&&p.jsx("div",{style:{marginTop:8,marginLeft:0,display:"flex",flexDirection:"column",gap:6,paddingLeft:12,borderLeft:`3px solid ${q}`},children:e.children.map(_=>p.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:6,background:"#f0f4f8",border:"1px solid #d0d9e8",transition:"all 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.background=kt,o.currentTarget.style.borderColor=q},onMouseLeave:o=>{o.currentTarget.style.background="#f0f4f8",o.currentTarget.style.borderColor="#d0d9e8"},children:[p.jsx("div",{style:{flex:1},children:p.jsx("div",{style:{fontSize:12,color:"#333",fontWeight:500},children:_.displayName})}),p.jsx("button",{onClick:()=>It(_),style:{background:q,color:G,border:"none",padding:"4px 8px",borderRadius:4,cursor:"pointer",fontSize:11,fontWeight:600,transition:"all 0.2s ease"},onMouseEnter:o=>{o.target.style.background=G,o.target.style.color=q},onMouseLeave:o=>{o.target.style.background=q,o.target.style.color=G},children:"Info"})]},_.id))})]},e.id)})})]}),p.jsx("div",{style:le,children:K&&p.jsx(Se,{popupInfo:K,onClose:()=>{bt(null),ot(null)},onFlyTo:()=>{if(!K)return;const e=g.current.find(h=>h.id===K.id);e?De(e,s,n):K._mesh&&Kt(K._mesh,{padding:K._meshRadius||2,animate:!0,frames:45},s,n,t),bt(null)}})}),p.jsx("div",{"aria-label":"Camera controls",style:{position:"fixed",right:20,bottom:20,width:120,height:120,display:"flex",alignItems:"center",justifyContent:"center",zIndex:40,pointerEvents:"auto"}})]})}export{Ze as default};
